[0m15:09:55.698088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183881F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838822EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001838822ECD0>]}


============================== 15:09:55.698088 | 29008403-5b07-4d19-8059-869d5221c318 ==============================
[0m15:09:55.698088 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:09:55.698088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:09:55.760767 [info ] [MainThread]: dbt version: 1.8.7
[0m15:09:55.760767 [info ] [MainThread]: python version: 3.11.2
[0m15:09:55.760767 [info ] [MainThread]: python path: C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Scripts\python.exe
[0m15:09:55.760767 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m15:09:56.198775 [info ] [MainThread]: Using profiles dir at C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data
[0m15:09:56.198775 [info ] [MainThread]: Using profiles.yml file at C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data\profiles.yml
[0m15:09:56.198775 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data\dbt_project.yml
[0m15:09:56.198775 [info ] [MainThread]: adapter type: postgres
[0m15:09:56.198775 [info ] [MainThread]: adapter version: 1.8.2
[0m15:09:56.292744 [info ] [MainThread]: Configuration:
[0m15:09:56.306282 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:56.306282 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:56.308788 [info ] [MainThread]: Required dependencies:
[0m15:09:56.308788 [debug] [MainThread]: Executing "git --help"
[0m15:09:56.387263 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:56.387263 [debug] [MainThread]: STDERR: "b''"
[0m15:09:56.387263 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:56.387263 [info ] [MainThread]: Connection:
[0m15:09:56.387263 [info ] [MainThread]:   host: localhost
[0m15:09:56.387263 [info ] [MainThread]:   port: 5432
[0m15:09:56.387263 [info ] [MainThread]:   user: postgres
[0m15:09:56.387263 [info ] [MainThread]:   database: Telegram_data
[0m15:09:56.387263 [info ] [MainThread]:   schema: public
[0m15:09:56.387263 [info ] [MainThread]:   connect_timeout: 10
[0m15:09:56.387263 [info ] [MainThread]:   role: None
[0m15:09:56.387263 [info ] [MainThread]:   search_path: None
[0m15:09:56.387263 [info ] [MainThread]:   keepalives_idle: 0
[0m15:09:56.402890 [info ] [MainThread]:   sslmode: None
[0m15:09:56.402890 [info ] [MainThread]:   sslcert: None
[0m15:09:56.402890 [info ] [MainThread]:   sslkey: None
[0m15:09:56.402890 [info ] [MainThread]:   sslrootcert: None
[0m15:09:56.402890 [info ] [MainThread]:   application_name: dbt
[0m15:09:56.402890 [info ] [MainThread]:   retries: 1
[0m15:09:56.402890 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:09:56.434196 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:10:08.744062 [debug] [MainThread]: Using postgres connection "debug"
[0m15:10:08.744062 [debug] [MainThread]: On debug: select 1 as id
[0m15:10:08.744062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:09.032788 [debug] [MainThread]: SQL status: SELECT 1 in 0.297 seconds
[0m15:10:09.032788 [debug] [MainThread]: On debug: Close
[0m15:10:09.032788 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:10:09.032788 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:10:09.032788 [debug] [MainThread]: Command `dbt debug` succeeded at 15:10:09.032788 after 13.48 seconds
[0m15:10:09.048346 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:10:09.048346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018381C27E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018388653690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018381CD1E10>]}
[0m15:10:09.048346 [debug] [MainThread]: Flushing usage events
[0m15:10:10.744295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:00.865819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC702ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7083C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7080AD0>]}


============================== 17:52:00.949035 | e214d3f8-a231-43fd-ab8b-b9048f7af716 ==============================
[0m17:52:00.949035 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:52:00.951165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:52:02.541483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e214d3f8-a231-43fd-ab8b-b9048f7af716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC73A9B10>]}
[0m17:52:02.656192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e214d3f8-a231-43fd-ab8b-b9048f7af716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC4484390>]}
[0m17:52:02.658992 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:52:02.696269 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:52:02.696269 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:52:02.704318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e214d3f8-a231-43fd-ab8b-b9048f7af716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC6EC8210>]}
[0m17:52:09.327869 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_data.select_all' (models\select_all.sql) depends on a node named 'transformed_telegram_data' which was not found
[0m17:52:09.338289 [debug] [MainThread]: Command `dbt run` failed at 17:52:09.338289 after 8.90 seconds
[0m17:52:09.341974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7083BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC76CC810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC70231D0>]}
[0m17:52:09.343984 [debug] [MainThread]: Flushing usage events
[0m17:52:11.235775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:13.865360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDB321E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC44D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC44DED0>]}


============================== 17:58:13.912489 | 57df013e-1fa4-400c-bb32-e46025d1ef10 ==============================
[0m17:58:13.912489 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:58:13.912489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:15.056677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9CA6710>]}
[0m17:58:15.195277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9874650>]}
[0m17:58:15.198445 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:58:15.236227 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:58:15.236227 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:58:15.243635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC73E510>]}
[0m17:58:18.346736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDCA5F110>]}
[0m17:58:19.458222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDCB1C1D0>]}
[0m17:58:19.465113 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 423 macros
[0m17:58:19.465113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDCB790D0>]}
[0m17:58:19.465113 [info ] [MainThread]: 
[0m17:58:19.465113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:19.499677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m17:58:22.049558 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m17:58:22.049558 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m17:58:22.049558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:22.445693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.395 seconds
[0m17:58:22.445693 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m17:58:22.455358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m17:58:22.461850 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m17:58:22.461850 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m17:58:22.461850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:22.548952 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m17:58:22.548952 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m17:58:22.548952 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:58:22.826529 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.284 seconds
[0m17:58:22.841037 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m17:58:22.841037 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m17:58:22.856904 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:22.856904 [debug] [MainThread]: On master: BEGIN
[0m17:58:22.856904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:22.938949 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m17:58:22.938949 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:22.938949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:23.189144 [debug] [MainThread]: SQL status: SELECT 0 in 0.250 seconds
[0m17:58:23.189144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9876890>]}
[0m17:58:23.189144 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:23.189144 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:23.203683 [debug] [MainThread]: On master: BEGIN
[0m17:58:23.205195 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:58:23.205195 [debug] [MainThread]: On master: COMMIT
[0m17:58:23.205195 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:23.205195 [debug] [MainThread]: On master: COMMIT
[0m17:58:23.205195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:58:23.205195 [debug] [MainThread]: On master: Close
[0m17:58:23.205195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:23.214609 [info ] [MainThread]: 
[0m17:58:23.282073 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m17:58:23.293580 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:58:23.293580 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m17:58:23.293580 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m17:58:23.310207 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m17:58:23.310207 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m17:58:23.372012 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m17:58:23.421707 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:58:23.421707 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m17:58:23.421707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:23.610711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.181 seconds
[0m17:58:23.610711 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:58:23.614575 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:58:24.004308 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.392 seconds
[0m17:58:24.020002 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:58:24.020002 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:58:24.175194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.155 seconds
[0m17:58:24.222662 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m17:58:24.222662 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:58:24.222662 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m17:58:24.348631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.125 seconds
[0m17:58:24.364302 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m17:58:24.364302 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:58:24.379928 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:58:24.379928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:58:24.379928 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m17:58:24.379928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC92C5D0>]}
[0m17:58:24.379928 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.09s]
[0m17:58:24.395549 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m17:58:24.395549 [debug] [Thread-1 (]: Began running node model.telegram_data.select_all
[0m17:58:24.395549 [info ] [Thread-1 (]: 2 of 3 START sql view model public.select_all .................................. [RUN]
[0m17:58:24.395549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now model.telegram_data.select_all)
[0m17:58:24.404441 [debug] [Thread-1 (]: Began compiling node model.telegram_data.select_all
[0m17:58:24.414778 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m17:58:24.414778 [debug] [Thread-1 (]: Began executing node model.telegram_data.select_all
[0m17:58:24.465894 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m17:58:24.465894 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:58:24.465894 [debug] [Thread-1 (]: On model.telegram_data.select_all: BEGIN
[0m17:58:24.465894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:24.525680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m17:58:24.525680 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:58:24.525680 [debug] [Thread-1 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    -- models/select_all.sql

with source_data as (
    select * from "Telegram_data"."public"."transformed_telegram_data"
)

select 
    id,
    channel_name,
    message_text,
    timestamp
from source_data
  );
[0m17:58:24.533833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:58:24.549517 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:58:24.549517 [debug] [Thread-1 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all__dbt_tmp" rename to "select_all"
[0m17:58:24.549517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:58:24.549517 [debug] [Thread-1 (]: On model.telegram_data.select_all: COMMIT
[0m17:58:24.549517 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:58:24.549517 [debug] [Thread-1 (]: On model.telegram_data.select_all: COMMIT
[0m17:58:24.549517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:58:24.549517 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."select_all__dbt_backup"
[0m17:58:24.565117 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:58:24.565117 [debug] [Thread-1 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
drop view if exists "Telegram_data"."public"."select_all__dbt_backup" cascade
[0m17:58:24.565117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:58:24.565117 [debug] [Thread-1 (]: On model.telegram_data.select_all: Close
[0m17:58:24.565117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDE008690>]}
[0m17:58:24.565117 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.select_all ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m17:58:24.565117 [debug] [Thread-1 (]: Finished running node model.telegram_data.select_all
[0m17:58:24.565117 [debug] [Thread-1 (]: Began running node model.telegram_data.my_second_dbt_model
[0m17:58:24.565117 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:58:24.565117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m17:58:24.577541 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m17:58:24.584885 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m17:58:24.585321 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m17:58:24.585321 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m17:58:24.585321 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:58:24.585321 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m17:58:24.585321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:24.767267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.172 seconds
[0m17:58:24.767267 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:58:24.767267 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:58:24.767267 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:58:24.776324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:58:24.776324 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:58:24.780327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:58:24.780327 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m17:58:24.780327 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:58:24.780327 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m17:58:24.780327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:58:24.780327 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m17:58:24.780327 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:58:24.788703 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:58:24.788703 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:58:24.791189 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: Close
[0m17:58:24.791819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57df013e-1fa4-400c-bb32-e46025d1ef10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDDE8BB90>]}
[0m17:58:24.791819 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.23s]
[0m17:58:24.795810 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m17:58:24.795810 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:24.795810 [debug] [MainThread]: On master: BEGIN
[0m17:58:24.795810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:24.849753 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m17:58:24.849753 [debug] [MainThread]: On master: COMMIT
[0m17:58:24.849753 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:24.849753 [debug] [MainThread]: On master: COMMIT
[0m17:58:24.849753 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:58:24.849753 [debug] [MainThread]: On master: Close
[0m17:58:24.849753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:24.849753 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m17:58:24.849753 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m17:58:24.849753 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m17:58:24.849753 [info ] [MainThread]: 
[0m17:58:24.849753 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m17:58:24.849753 [debug] [MainThread]: Command end result
[0m17:58:24.930330 [info ] [MainThread]: 
[0m17:58:24.932312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:24.932312 [info ] [MainThread]: 
[0m17:58:24.932312 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:58:24.937955 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:24.937955 after 11.43 seconds
[0m17:58:24.937955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC1F3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDC1F2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD5EC2F10>]}
[0m17:58:24.937955 [debug] [MainThread]: Flushing usage events
[0m17:58:25.278814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:04.109139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0B1F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0B71F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0B70AD0>]}


============================== 17:59:04.123451 | bc65259f-6471-4533-b6b0-7eb29ce99571 ==============================
[0m17:59:04.123451 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:59:04.123451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:04.341748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0ED5990>]}
[0m17:59:04.436954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C9DF74190>]}
[0m17:59:04.436954 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:59:04.461215 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:59:04.789737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:04.789737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:04.843385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0EBC910>]}
[0m17:59:04.969111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0E5E710>]}
[0m17:59:04.975456 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 423 macros
[0m17:59:04.975456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA0FB1E50>]}
[0m17:59:04.979005 [info ] [MainThread]: 
[0m17:59:04.979005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:04.990204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m17:59:05.072199 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m17:59:05.072199 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m17:59:05.072199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:05.135583 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m17:59:05.135583 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m17:59:05.135583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m17:59:05.151995 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m17:59:05.151995 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m17:59:05.151995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:05.199933 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m17:59:05.199933 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m17:59:05.199933 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:59:05.214481 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m17:59:05.214481 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m17:59:05.214481 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m17:59:05.222062 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:05.230569 [debug] [MainThread]: On master: BEGIN
[0m17:59:05.231246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:05.286310 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m17:59:05.286310 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:05.286310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:05.420470 [debug] [MainThread]: SQL status: SELECT 2 in 0.130 seconds
[0m17:59:05.420470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA105D610>]}
[0m17:59:05.420470 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:05.420470 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:05.420470 [debug] [MainThread]: On master: BEGIN
[0m17:59:05.420470 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:59:05.420470 [debug] [MainThread]: On master: COMMIT
[0m17:59:05.420470 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:05.435909 [debug] [MainThread]: On master: COMMIT
[0m17:59:05.438180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:05.438180 [debug] [MainThread]: On master: Close
[0m17:59:05.438180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:05.438180 [info ] [MainThread]: 
[0m17:59:05.438180 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m17:59:05.438180 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m17:59:05.452476 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:59:05.456960 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m17:59:05.456960 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m17:59:05.455767 [info ] [Thread-2 (]: 2 of 3 START sql view model public.select_all .................................. [RUN]
[0m17:59:05.476718 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m17:59:05.476718 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m17:59:05.476718 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m17:59:05.476718 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m17:59:05.532443 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m17:59:05.539506 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m17:59:05.539506 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.544183 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m17:59:05.544183 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m17:59:05.572782 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m17:59:05.572782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:05.572782 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.572782 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m17:59:05.578915 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:05.619298 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m17:59:05.619298 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.627690 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    -- models/select_all.sql

with source_data as (
    select * from "Telegram_data"."public"."transformed_telegram_data"
)

select 
    id,
    channel_name,
    message_text,
    timestamp
from source_data
  );
[0m17:59:05.627690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m17:59:05.627690 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.627690 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:59:05.635147 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m17:59:05.635147 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.635147 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:59:05.635147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:59:05.635147 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.635147 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:59:05.635147 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:59:05.650775 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.650775 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all" rename to "select_all__dbt_backup"
[0m17:59:05.650775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:05.667140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m17:59:05.670196 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m17:59:05.682199 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.682199 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.682199 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all__dbt_tmp" rename to "select_all"
[0m17:59:05.682199 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m17:59:05.682199 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:05.682199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:59:05.682199 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m17:59:05.682199 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m17:59:05.698619 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.698619 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m17:59:05.698619 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m17:59:05.698619 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:59:05.714027 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m17:59:05.714027 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."select_all__dbt_backup"
[0m17:59:05.714027 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m17:59:05.714027 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
drop view if exists "Telegram_data"."public"."select_all__dbt_backup" cascade
[0m17:59:05.794076 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.067 seconds
[0m17:59:05.794076 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m17:59:05.794076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m17:59:05.804801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA1615690>]}
[0m17:59:05.811202 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m17:59:05.814186 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.select_all ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:59:05.815338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA11D0950>]}
[0m17:59:05.817348 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m17:59:05.817348 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.36s]
[0m17:59:05.824854 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m17:59:05.826848 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m17:59:05.828440 [info ] [Thread-4 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:59:05.832209 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m17:59:05.834481 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m17:59:05.841619 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m17:59:05.841619 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m17:59:05.849595 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m17:59:05.849595 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:59:05.856980 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m17:59:05.856980 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:59:05.913002 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m17:59:05.913766 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:59:05.913766 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:59:05.916042 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:59:05.921047 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:59:05.921047 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:59:05.921047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:05.929049 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m17:59:05.929049 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:59:05.929049 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m17:59:05.941802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m17:59:06.014850 [debug] [Thread-4 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m17:59:06.014850 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m17:59:06.014850 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:59:06.014850 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:59:06.029404 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: Close
[0m17:59:06.030122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc65259f-6471-4533-b6b0-7eb29ce99571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA2A073D0>]}
[0m17:59:06.030122 [info ] [Thread-4 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:59:06.030122 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m17:59:06.039619 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.039619 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.039619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:06.165379 [debug] [MainThread]: SQL status: BEGIN in 0.123 seconds
[0m17:59:06.165379 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.165379 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.165379 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.165379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:06.170932 [debug] [MainThread]: On master: Close
[0m17:59:06.170932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:06.170932 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m17:59:06.170932 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m17:59:06.170932 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m17:59:06.170932 [debug] [MainThread]: Connection 'model.telegram_data.select_all' was properly closed.
[0m17:59:06.170932 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m17:59:06.170932 [info ] [MainThread]: 
[0m17:59:06.170932 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m17:59:06.181836 [debug] [MainThread]: Command end result
[0m17:59:06.249467 [info ] [MainThread]: 
[0m17:59:06.249467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:06.249467 [info ] [MainThread]: 
[0m17:59:06.256017 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:59:06.256017 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:06.256017 after 2.36 seconds
[0m17:59:06.256017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C9A4D84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C9A850ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C9A5B3B10>]}
[0m17:59:06.256017 [debug] [MainThread]: Flushing usage events
[0m17:59:08.115204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:52.673358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E90FF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E914D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E914DAD0>]}


============================== 18:09:52.673358 | f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf ==============================
[0m18:09:52.673358 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:09:52.673358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:09:53.564106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E9126FD0>]}
[0m18:09:53.611650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E6554950>]}
[0m18:09:53.611650 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:09:53.635665 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:09:54.236824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:09:54.236824 [debug] [MainThread]: Partial parsing: added file: telegram_data://tests\my_test.sql
[0m18:09:54.425390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E910EAD0>]}
[0m18:09:55.474464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E9A3BDD0>]}
[0m18:09:55.475461 [info ] [MainThread]: Found 3 models, 5 data tests, 1 source, 423 macros
[0m18:09:55.476141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E951F610>]}
[0m18:09:55.476141 [info ] [MainThread]: 
[0m18:09:55.476141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:55.476141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m18:10:01.060307 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:10:01.060307 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m18:10:01.060307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:01.126396 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m18:10:01.126396 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:10:01.126396 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:10:01.149094 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m18:10:01.149094 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m18:10:01.155599 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m18:10:01.155599 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.155599 [debug] [MainThread]: On master: BEGIN
[0m18:10:01.155599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:01.202688 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m18:10:01.202688 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.202688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:01.202688 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m18:10:01.218356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5db17dc-5d7f-47b4-aa8c-7c85d59f51bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E9727410>]}
[0m18:10:01.218356 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:01.218356 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.218356 [debug] [MainThread]: On master: BEGIN
[0m18:10:01.218356 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:10:01.218356 [debug] [MainThread]: On master: COMMIT
[0m18:10:01.218356 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.218356 [debug] [MainThread]: On master: COMMIT
[0m18:10:01.218356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:01.218356 [debug] [MainThread]: On master: Close
[0m18:10:01.218356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:01.218356 [info ] [MainThread]: 
[0m18:10:01.236059 [debug] [Thread-1 (]: Began running node test.telegram_data.my_test
[0m18:10:01.236317 [debug] [Thread-2 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:01.237316 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:01.238222 [debug] [Thread-4 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:01.238222 [info ] [Thread-1 (]: 1 of 5 START test my_test ...................................................... [RUN]
[0m18:10:01.240265 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:10:01.241263 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:10:01.242895 [info ] [Thread-4 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:10:01.242895 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.my_test'
[0m18:10:01.246811 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:10:01.247640 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778'
[0m18:10:01.247640 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321'
[0m18:10:01.249172 [debug] [Thread-1 (]: Began compiling node test.telegram_data.my_test
[0m18:10:01.250171 [debug] [Thread-2 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:01.250171 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:01.251234 [debug] [Thread-4 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:01.251234 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m18:10:01.260345 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:10:01.276319 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:10:01.277508 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:10:01.277508 [debug] [Thread-1 (]: Began executing node test.telegram_data.my_test
[0m18:10:01.277508 [debug] [Thread-2 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:01.288427 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:01.294270 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.my_test"
[0m18:10:01.294270 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:10:01.309803 [debug] [Thread-4 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:01.313804 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:10:01.318788 [debug] [Thread-4 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:10:01.349327 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:10:01.349327 [debug] [Thread-1 (]: On test.telegram_data.my_test: BEGIN
[0m18:10:01.349327 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:01.374464 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:10:01.374464 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:10:01.374464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:10:01.391994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:10:01.391994 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:10:01.391994 [debug] [Thread-1 (]: On test.telegram_data.my_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/select_all.sql

select * from "Telegram_data"."public"."select_all"
where message_text is null
      
    ) dbt_internal_test
[0m18:10:01.406000 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:10:01.406000 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:10:01.406000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:10:01.421626 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m18:10:01.421626 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:10:01.421626 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:10:01.421626 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:01.421626 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:10:01.421626 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:10:01.454261 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m18:10:01.454261 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:10:01.454261 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:10:01.454261 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:10:01.437253 [error] [Thread-2 (]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.19s]
[0m18:10:01.454261 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:10:01.454261 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:10:01.454261 [debug] [Thread-2 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:01.454261 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:10:01.454261 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:10:01.454261 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:01.469266 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:10:01.470401 [info ] [Thread-2 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:10:01.472440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:10:01.471446 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.22s]
[0m18:10:01.474434 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:01.475273 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:01.486950 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:10:01.510619 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m18:10:01.510619 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:10:01.510619 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:01.510619 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:01.510619 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:10:01.510619 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:10:01.510619 [info ] [Thread-4 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.26s]
[0m18:10:01.510619 [debug] [Thread-4 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:01.527476 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:01.528738 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:10:01.528738 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:10:01.528738 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:10:01.528738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:10:01.690610 [debug] [Thread-2 (]: SQL status: BEGIN in 0.160 seconds
[0m18:10:01.690610 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:10:01.690610 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:10:01.690610 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:10:01.690610 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:10:01.690610 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:10:01.690610 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.22s]
[0m18:10:01.690610 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:01.728535 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.330 seconds
[0m18:10:01.729605 [debug] [Thread-1 (]: On test.telegram_data.my_test: ROLLBACK
[0m18:10:01.729605 [debug] [Thread-1 (]: On test.telegram_data.my_test: Close
[0m18:10:01.729605 [error] [Thread-1 (]: 1 of 5 FAIL 1419 my_test ....................................................... [[31mFAIL 1419[0m in 0.49s]
[0m18:10:01.729605 [debug] [Thread-1 (]: Finished running node test.telegram_data.my_test
[0m18:10:01.737058 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.737058 [debug] [MainThread]: On master: BEGIN
[0m18:10:01.738055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:01.780184 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m18:10:01.780184 [debug] [MainThread]: On master: COMMIT
[0m18:10:01.780184 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:01.780184 [debug] [MainThread]: On master: COMMIT
[0m18:10:01.780184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:10:01.780184 [debug] [MainThread]: On master: Close
[0m18:10:01.780184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:01.780184 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m18:10:01.780184 [debug] [MainThread]: Connection 'test.telegram_data.my_test' was properly closed.
[0m18:10:01.780184 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:10:01.780184 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:10:01.780184 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:10:01.780184 [info ] [MainThread]: 
[0m18:10:01.780184 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m18:10:01.794531 [debug] [MainThread]: Command end result
[0m18:10:01.828513 [info ] [MainThread]: 
[0m18:10:01.829868 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:10:01.831485 [info ] [MainThread]: 
[0m18:10:01.833432 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:10:01.834706 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:10:01.835870 [info ] [MainThread]: 
[0m18:10:01.836871 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:10:01.837867 [info ] [MainThread]: 
[0m18:10:01.839863 [error] [MainThread]: [31mFailure in test my_test (tests\my_test.sql)[0m
[0m18:10:01.841307 [error] [MainThread]:   Got 1419 results, configured to fail if != 0
[0m18:10:01.842444 [info ] [MainThread]: 
[0m18:10:01.844441 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\tests\my_test.sql
[0m18:10:01.845438 [info ] [MainThread]: 
[0m18:10:01.846434 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:10:01.849727 [debug] [MainThread]: Command `dbt test` failed at 18:10:01.849425 after 9.73 seconds
[0m18:10:01.850435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E2AD84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E9160E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293E91631D0>]}
[0m18:10:01.852432 [debug] [MainThread]: Flushing usage events
[0m18:10:02.133118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:06.694462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834445AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344487050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344487210>]}


============================== 18:12:06.694462 | 2ca675bd-bb39-496c-8391-eba9378d1992 ==============================
[0m18:12:06.694462 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:12:06.694462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:12:06.886201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344776C50>]}
[0m18:12:06.929962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183418B4310>]}
[0m18:12:06.929962 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:12:06.945583 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:12:07.118810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:07.118810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:07.165729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183449A1B50>]}
[0m18:12:07.307444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344CC9750>]}
[0m18:12:07.307444 [info ] [MainThread]: Found 3 models, 5 data tests, 1 source, 423 macros
[0m18:12:07.307444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183447D8710>]}
[0m18:12:07.307444 [info ] [MainThread]: 
[0m18:12:07.307444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:07.307444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m18:12:07.385928 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:12:07.385928 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m18:12:07.385928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:07.542801 [debug] [ThreadPool]: SQL status: BEGIN in 0.154 seconds
[0m18:12:07.542801 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:12:07.542801 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:12:07.558429 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m18:12:07.558429 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m18:12:07.558429 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m18:12:07.558429 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:07.558429 [debug] [MainThread]: On master: BEGIN
[0m18:12:07.558429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:07.605488 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:12:07.605488 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:07.605488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:07.621099 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m18:12:07.621099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca675bd-bb39-496c-8391-eba9378d1992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018343A033D0>]}
[0m18:12:07.621099 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:07.621099 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:07.621099 [debug] [MainThread]: On master: BEGIN
[0m18:12:07.621099 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:12:07.621099 [debug] [MainThread]: On master: COMMIT
[0m18:12:07.621099 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:07.621099 [debug] [MainThread]: On master: COMMIT
[0m18:12:07.621099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:07.621099 [debug] [MainThread]: On master: Close
[0m18:12:07.621099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:07.621099 [info ] [MainThread]: 
[0m18:12:07.636684 [debug] [Thread-1 (]: Began running node test.telegram_data.my_test
[0m18:12:07.636684 [debug] [Thread-2 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:07.636684 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:07.636684 [debug] [Thread-4 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:07.636684 [info ] [Thread-1 (]: 1 of 5 START test my_test ...................................................... [RUN]
[0m18:12:07.636684 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:12:07.636684 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:12:07.636684 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.my_test'
[0m18:12:07.636684 [info ] [Thread-4 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:12:07.636684 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:12:07.636684 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778'
[0m18:12:07.636684 [debug] [Thread-1 (]: Began compiling node test.telegram_data.my_test
[0m18:12:07.636684 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321'
[0m18:12:07.636684 [debug] [Thread-2 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:07.636684 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:07.652310 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m18:12:07.652310 [debug] [Thread-4 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:07.667930 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:07.678937 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:07.683943 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:07.683943 [debug] [Thread-1 (]: Began executing node test.telegram_data.my_test
[0m18:12:07.683943 [debug] [Thread-2 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:07.683943 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:07.700060 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.my_test"
[0m18:12:07.700060 [debug] [Thread-4 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:07.700060 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:07.715735 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:07.715735 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:12:07.715735 [debug] [Thread-4 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:07.715735 [debug] [Thread-1 (]: On test.telegram_data.my_test: BEGIN
[0m18:12:07.715735 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:07.715735 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:07.715735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:07.715735 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:07.715735 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:12:07.715735 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:12:07.731312 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:12:07.731312 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:12:07.731312 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:12:07.731312 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:07.779214 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m18:12:07.779214 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:07.779214 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:12:07.779214 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:12:07.779214 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:12:07.779214 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:12:07.779214 [error] [Thread-2 (]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.14s]
[0m18:12:07.794717 [debug] [Thread-2 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:07.796541 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:07.796541 [debug] [Thread-4 (]: SQL status: BEGIN in 0.065 seconds
[0m18:12:07.796541 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m18:12:07.796541 [info ] [Thread-2 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:12:07.796541 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:07.796541 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:07.796541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:12:07.796541 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:07.796541 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:12:07.796541 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:07.796541 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:07.796541 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:12:07.810586 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:12:07.810586 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:12:07.810586 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:12:07.810586 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:07.810586 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:12:07.810586 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:12:07.810586 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:07.810586 [info ] [Thread-4 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.17s]
[0m18:12:07.810586 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.17s]
[0m18:12:07.826218 [debug] [Thread-4 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:07.827375 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:07.827375 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:07.827375 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:12:07.827375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:07.873333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m18:12:07.873333 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:12:07.873333 [debug] [Thread-1 (]: On test.telegram_data.my_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/select_all.sql

select * from "Telegram_data"."public"."select_all"
where message_text is null
      
    ) dbt_internal_test
[0m18:12:07.879369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:12:07.879369 [debug] [Thread-1 (]: On test.telegram_data.my_test: ROLLBACK
[0m18:12:07.879369 [debug] [Thread-1 (]: On test.telegram_data.my_test: Close
[0m18:12:07.879369 [error] [Thread-1 (]: 1 of 5 FAIL 1419 my_test ....................................................... [[31mFAIL 1419[0m in 0.24s]
[0m18:12:07.879369 [debug] [Thread-1 (]: Finished running node test.telegram_data.my_test
[0m18:12:07.984236 [debug] [Thread-2 (]: SQL status: BEGIN in 0.157 seconds
[0m18:12:07.984236 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:07.984236 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:07.984236 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:07.984236 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:12:07.984236 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:12:07.984236 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.19s]
[0m18:12:07.984236 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:07.984236 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:07.984236 [debug] [MainThread]: On master: BEGIN
[0m18:12:07.984236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:08.142564 [debug] [MainThread]: SQL status: BEGIN in 0.152 seconds
[0m18:12:08.142564 [debug] [MainThread]: On master: COMMIT
[0m18:12:08.142564 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:08.142564 [debug] [MainThread]: On master: COMMIT
[0m18:12:08.142564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:08.142564 [debug] [MainThread]: On master: Close
[0m18:12:08.142564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:08.142564 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m18:12:08.142564 [debug] [MainThread]: Connection 'test.telegram_data.my_test' was properly closed.
[0m18:12:08.157294 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:12:08.157294 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:12:08.158300 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:12:08.158300 [info ] [MainThread]: 
[0m18:12:08.158300 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m18:12:08.158300 [debug] [MainThread]: Command end result
[0m18:12:08.202527 [info ] [MainThread]: 
[0m18:12:08.202527 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:12:08.202527 [info ] [MainThread]: 
[0m18:12:08.202527 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:12:08.208622 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:12:08.209736 [info ] [MainThread]: 
[0m18:12:08.210835 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:12:08.212472 [info ] [MainThread]: 
[0m18:12:08.214653 [error] [MainThread]: [31mFailure in test my_test (tests\my_test.sql)[0m
[0m18:12:08.216679 [error] [MainThread]:   Got 1419 results, configured to fail if != 0
[0m18:12:08.218626 [info ] [MainThread]: 
[0m18:12:08.220485 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\tests\my_test.sql
[0m18:12:08.221661 [info ] [MainThread]: 
[0m18:12:08.222992 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:12:08.225265 [debug] [MainThread]: Command `dbt test` failed at 18:12:08.224678 after 1.64 seconds
[0m18:12:08.225769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344498610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833DEC84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018344232950>]}
[0m18:12:08.226282 [debug] [MainThread]: Flushing usage events
[0m18:12:09.454200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:36.947584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFACF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFB1F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFB1CED0>]}


============================== 18:12:36.947584 | db07a768-dbfe-42b7-9570-cd353e38fa89 ==============================
[0m18:12:36.947584 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:12:36.947584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:12:37.180869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFB1E990>]}
[0m18:12:37.262304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ACF24850>]}
[0m18:12:37.262304 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:12:37.262304 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:12:37.442845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:37.442845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:37.505359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFF65690>]}
[0m18:12:37.711436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B03294D0>]}
[0m18:12:37.711436 [info ] [MainThread]: Found 3 models, 5 data tests, 1 source, 423 macros
[0m18:12:37.711436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFE70550>]}
[0m18:12:37.711436 [info ] [MainThread]: 
[0m18:12:37.711436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:37.711436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m18:12:37.816459 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:12:37.817460 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m18:12:37.817460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:37.980494 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m18:12:37.980494 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:12:37.980494 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:12:37.988543 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m18:12:37.988543 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m18:12:37.988543 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m18:12:37.988543 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:37.988543 [debug] [MainThread]: On master: BEGIN
[0m18:12:37.988543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:38.134911 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m18:12:38.145987 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:38.145987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:38.145987 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m18:12:38.145987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db07a768-dbfe-42b7-9570-cd353e38fa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0300F90>]}
[0m18:12:38.145987 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:38.145987 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:38.145987 [debug] [MainThread]: On master: BEGIN
[0m18:12:38.145987 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:12:38.145987 [debug] [MainThread]: On master: COMMIT
[0m18:12:38.145987 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:38.161616 [debug] [MainThread]: On master: COMMIT
[0m18:12:38.161616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:38.161616 [debug] [MainThread]: On master: Close
[0m18:12:38.161616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:38.161616 [info ] [MainThread]: 
[0m18:12:38.161616 [debug] [Thread-1 (]: Began running node test.telegram_data.my_test
[0m18:12:38.161616 [info ] [Thread-1 (]: 1 of 5 START test my_test ...................................................... [RUN]
[0m18:12:38.161616 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.my_test'
[0m18:12:38.172040 [debug] [Thread-1 (]: Began compiling node test.telegram_data.my_test
[0m18:12:38.185291 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m18:12:38.187250 [debug] [Thread-1 (]: Began executing node test.telegram_data.my_test
[0m18:12:38.201712 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.my_test"
[0m18:12:38.201712 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:12:38.201712 [debug] [Thread-1 (]: On test.telegram_data.my_test: BEGIN
[0m18:12:38.201712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:38.256838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:12:38.257823 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:12:38.258816 [debug] [Thread-1 (]: On test.telegram_data.my_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/select_all.sql

select * from "Telegram_data"."public"."select_all"
where message_text is null
      
    ) dbt_internal_test
[0m18:12:38.263078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:12:38.263078 [debug] [Thread-1 (]: On test.telegram_data.my_test: ROLLBACK
[0m18:12:38.263078 [debug] [Thread-1 (]: On test.telegram_data.my_test: Close
[0m18:12:38.263078 [error] [Thread-1 (]: 1 of 5 FAIL 1419 my_test ....................................................... [[31mFAIL 1419[0m in 0.10s]
[0m18:12:38.263078 [debug] [Thread-1 (]: Finished running node test.telegram_data.my_test
[0m18:12:38.263078 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:38.263078 [info ] [Thread-1 (]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:12:38.263078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.my_test, now test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:12:38.263078 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:38.284799 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:38.286043 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:38.286043 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:38.286043 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:38.286043 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:12:38.286043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:38.335132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:12:38.335132 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:38.335132 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:12:38.335132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:38.335132 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:12:38.345644 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:12:38.346725 [error] [Thread-1 (]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
[0m18:12:38.349087 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:38.350132 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:38.350132 [info ] [Thread-1 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:12:38.352072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.not_null_my_second_dbt_model_id.151b76d778)
[0m18:12:38.353071 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:38.357057 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:38.358054 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:38.360047 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:38.361044 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:38.362523 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:12:38.362965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:38.523580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m18:12:38.523580 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:38.523580 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:12:38.523580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:38.523580 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:12:38.535589 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:12:38.535589 [info ] [Thread-1 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.18s]
[0m18:12:38.538223 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:38.539463 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:38.539463 [info ] [Thread-1 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:12:38.539463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_second_dbt_model_id.151b76d778, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m18:12:38.539463 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:38.554382 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:38.554382 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:38.562513 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:38.564499 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:38.565831 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:12:38.566836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:38.597260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:12:38.597260 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:38.612341 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:38.615397 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:38.617378 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:12:38.618327 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:12:38.618327 [info ] [Thread-1 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
[0m18:12:38.620321 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:38.621323 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:38.621323 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:12:38.623316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.unique_my_first_dbt_model_id.16e066b321, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:12:38.623316 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:38.627302 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:38.628300 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:38.633417 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:38.635370 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:38.635874 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:12:38.636929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:38.680727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:12:38.680727 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:38.680727 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:38.680727 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:12:38.680727 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:12:38.680727 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:12:38.680727 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:12:38.696628 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:38.698626 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:38.699617 [debug] [MainThread]: On master: BEGIN
[0m18:12:38.700614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:38.735934 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:12:38.735934 [debug] [MainThread]: On master: COMMIT
[0m18:12:38.735934 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:38.735934 [debug] [MainThread]: On master: COMMIT
[0m18:12:38.745712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:12:38.747737 [debug] [MainThread]: On master: Close
[0m18:12:38.748268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:38.748268 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m18:12:38.748268 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:12:38.748268 [info ] [MainThread]: 
[0m18:12:38.748268 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m18:12:38.748268 [debug] [MainThread]: Command end result
[0m18:12:38.796782 [info ] [MainThread]: 
[0m18:12:38.798354 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:12:38.798354 [info ] [MainThread]: 
[0m18:12:38.798354 [error] [MainThread]: [31mFailure in test my_test (tests\my_test.sql)[0m
[0m18:12:38.798354 [error] [MainThread]:   Got 1419 results, configured to fail if != 0
[0m18:12:38.803445 [info ] [MainThread]: 
[0m18:12:38.805481 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\tests\my_test.sql
[0m18:12:38.806470 [info ] [MainThread]: 
[0m18:12:38.807466 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:12:38.808464 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:12:38.809459 [info ] [MainThread]: 
[0m18:12:38.811457 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:12:38.814447 [info ] [MainThread]: 
[0m18:12:38.816935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:12:38.819970 [debug] [MainThread]: Command `dbt test` failed at 18:12:38.819970 after 1.96 seconds
[0m18:12:38.820966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AFAC2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A9682350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A9682290>]}
[0m18:12:38.820966 [debug] [MainThread]: Flushing usage events
[0m18:12:39.693018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:11.899117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77C8EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77CDEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77CDEFD0>]}


============================== 18:15:11.916185 | 7a8245df-ac17-4fec-ac79-97e752258261 ==============================
[0m18:15:11.916185 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:11.916185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:12.100430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77F83390>]}
[0m18:15:12.168062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A750E4610>]}
[0m18:15:12.170204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:15:12.178127 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:12.345728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:15:12.361405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:15:12.408830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78125890>]}
[0m18:15:12.550159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A784EBF50>]}
[0m18:15:12.550159 [info ] [MainThread]: Found 3 models, 5 data tests, 1 source, 423 macros
[0m18:15:12.550159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78083010>]}
[0m18:15:12.550159 [info ] [MainThread]: 
[0m18:15:12.550159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:15:12.550159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m18:15:12.644128 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:15:12.644128 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m18:15:12.645102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:12.685843 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m18:15:12.685843 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:15:12.685843 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:15:12.697963 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m18:15:12.697963 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m18:15:12.697963 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m18:15:12.707324 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:12.707324 [debug] [MainThread]: On master: BEGIN
[0m18:15:12.713331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:15:12.857411 [debug] [MainThread]: SQL status: BEGIN in 0.149 seconds
[0m18:15:12.857411 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:12.857411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:15:12.872985 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m18:15:12.872985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8245df-ac17-4fec-ac79-97e752258261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78123AD0>]}
[0m18:15:12.872985 [debug] [MainThread]: On master: ROLLBACK
[0m18:15:12.872985 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:12.872985 [debug] [MainThread]: On master: BEGIN
[0m18:15:12.872985 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:15:12.872985 [debug] [MainThread]: On master: COMMIT
[0m18:15:12.872985 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:12.872985 [debug] [MainThread]: On master: COMMIT
[0m18:15:12.872985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:12.872985 [debug] [MainThread]: On master: Close
[0m18:15:12.872985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:12.872985 [info ] [MainThread]: 
[0m18:15:12.889028 [debug] [Thread-1 (]: Began running node test.telegram_data.my_test
[0m18:15:12.889028 [debug] [Thread-2 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:15:12.889028 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:15:12.889028 [debug] [Thread-4 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:15:12.889028 [info ] [Thread-1 (]: 1 of 5 START test my_test ...................................................... [RUN]
[0m18:15:12.889028 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:15:12.889028 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:15:12.889028 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.my_test'
[0m18:15:12.889028 [info ] [Thread-4 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:15:12.889028 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:15:12.889028 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778'
[0m18:15:12.889028 [debug] [Thread-1 (]: Began compiling node test.telegram_data.my_test
[0m18:15:12.889028 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321'
[0m18:15:12.889028 [debug] [Thread-2 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:15:12.889028 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:15:12.915481 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m18:15:12.916455 [debug] [Thread-4 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:15:12.921091 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:15:12.934663 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:15:12.934663 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:15:12.934663 [debug] [Thread-1 (]: Began executing node test.telegram_data.my_test
[0m18:15:12.934663 [debug] [Thread-2 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:15:12.934663 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:15:12.949123 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.my_test"
[0m18:15:12.966199 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:15:12.966199 [debug] [Thread-4 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:15:12.966199 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:15:12.966199 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:15:12.966199 [debug] [Thread-4 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:15:12.966199 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:15:12.966199 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:15:12.966199 [debug] [Thread-1 (]: On test.telegram_data.my_test: BEGIN
[0m18:15:12.966199 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m18:15:12.966199 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:15:12.981206 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m18:15:12.982727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:15:12.983124 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:15:12.983124 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m18:15:12.983124 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:15:12.986668 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:15:13.041646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m18:15:13.042613 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.my_test"
[0m18:15:13.042613 [debug] [Thread-1 (]: On test.telegram_data.my_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.my_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- tests/select_all.sql

select * from "Telegram_data"."public"."select_all"
where message_text is null
      
    ) dbt_internal_test
[0m18:15:13.048985 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:15:13.056027 [debug] [Thread-1 (]: On test.telegram_data.my_test: ROLLBACK
[0m18:15:13.056979 [debug] [Thread-1 (]: On test.telegram_data.my_test: Close
[0m18:15:13.057961 [debug] [Thread-3 (]: SQL status: BEGIN in 0.072 seconds
[0m18:15:13.057961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.075 seconds
[0m18:15:13.059031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.072 seconds
[0m18:15:13.060031 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:15:13.060031 [error] [Thread-1 (]: 1 of 5 FAIL 1419 my_test ....................................................... [[31mFAIL 1419[0m in 0.17s]
[0m18:15:13.062028 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:15:13.063063 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:15:13.064024 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:15:13.065014 [debug] [Thread-1 (]: Finished running node test.telegram_data.my_test
[0m18:15:13.065663 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m18:15:13.065663 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:13.065663 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:15:13.065663 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:15:13.065663 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:15:13.065663 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:15:13.071704 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:15:13.073700 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m18:15:13.075694 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m18:15:13.076690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.my_test, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:15:13.077934 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m18:15:13.077934 [debug] [Thread-3 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:15:13.077934 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:15:13.081902 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:15:13.083353 [debug] [Thread-4 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:15:13.084350 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.19s]
[0m18:15:13.085395 [error] [Thread-2 (]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.20s]
[0m18:15:13.091594 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:15:13.093662 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:15:13.093662 [info ] [Thread-4 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.20s]
[0m18:15:13.096367 [debug] [Thread-2 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:15:13.097370 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:15:13.098367 [debug] [Thread-4 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:15:13.102446 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:15:13.105612 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:15:13.106559 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m18:15:13.106559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:13.150266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:15:13.150266 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:15:13.150266 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:15:13.150266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:15:13.150266 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m18:15:13.150266 [debug] [Thread-1 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:15:13.150266 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
[0m18:15:13.165946 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:15:13.167881 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:13.168954 [debug] [MainThread]: On master: BEGIN
[0m18:15:13.169874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:15:13.208204 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m18:15:13.215763 [debug] [MainThread]: On master: COMMIT
[0m18:15:13.216812 [debug] [MainThread]: Using postgres connection "master"
[0m18:15:13.217769 [debug] [MainThread]: On master: COMMIT
[0m18:15:13.218812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:15:13.219766 [debug] [MainThread]: On master: Close
[0m18:15:13.220772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:13.221653 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m18:15:13.221653 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:15:13.221653 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m18:15:13.221653 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:15:13.221653 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:15:13.221653 [info ] [MainThread]: 
[0m18:15:13.221653 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m18:15:13.221653 [debug] [MainThread]: Command end result
[0m18:15:13.253763 [info ] [MainThread]: 
[0m18:15:13.264886 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:15:13.265891 [info ] [MainThread]: 
[0m18:15:13.267621 [error] [MainThread]: [31mFailure in test my_test (tests\my_test.sql)[0m
[0m18:15:13.269648 [error] [MainThread]:   Got 1419 results, configured to fail if != 0
[0m18:15:13.270608 [info ] [MainThread]: 
[0m18:15:13.272282 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\tests\my_test.sql
[0m18:15:13.273318 [info ] [MainThread]: 
[0m18:15:13.274320 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:15:13.275277 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:15:13.276274 [info ] [MainThread]: 
[0m18:15:13.277217 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:15:13.278236 [info ] [MainThread]: 
[0m18:15:13.279238 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:15:13.280235 [debug] [MainThread]: Command `dbt test` failed at 18:15:13.280235 after 1.49 seconds
[0m18:15:13.281250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77CF34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A716384D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A77A62950>]}
[0m18:15:13.282228 [debug] [MainThread]: Flushing usage events
[0m18:15:15.399496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:04.768780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8588550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8588F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8588A10>]}


============================== 18:17:04.780378 | d4c52e69-0e36-42bb-ab20-f246452154f7 ==============================
[0m18:17:04.780378 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:04.781631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:04.968625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C88A17D0>]}
[0m18:17:05.012879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C59E52D0>]}
[0m18:17:05.012879 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:17:05.028577 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:17:05.181351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:05.181351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:05.227660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8AC07D0>]}
[0m18:17:05.337393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8A26650>]}
[0m18:17:05.337393 [info ] [MainThread]: Found 3 models, 5 data tests, 1 source, 423 macros
[0m18:17:05.337393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8A07650>]}
[0m18:17:05.337393 [info ] [MainThread]: 
[0m18:17:05.337393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:05.337393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m18:17:05.429430 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:17:05.430426 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m18:17:05.430426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:05.579040 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m18:17:05.579040 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m18:17:05.579040 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:17:05.579040 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m18:17:05.579040 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m18:17:05.579040 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m18:17:05.594669 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:05.594669 [debug] [MainThread]: On master: BEGIN
[0m18:17:05.594669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:05.641537 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m18:17:05.641537 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:05.641537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:05.657162 [debug] [MainThread]: SQL status: SELECT 2 in 0.012 seconds
[0m18:17:05.660297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c52e69-0e36-42bb-ab20-f246452154f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C8A26A90>]}
[0m18:17:05.660297 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:05.660297 [debug] [MainThread]: On master: Close
[0m18:17:05.660297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:17:05.660297 [info ] [MainThread]: 
[0m18:17:05.669384 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m18:17:05.669384 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m18:17:05.669384 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m18:17:05.672888 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m18:17:05.672888 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m18:17:05.674804 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m18:17:05.686942 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m18:17:05.689162 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m18:17:05.689162 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m18:17:05.689162 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m18:17:05.689162 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m18:17:05.689162 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m18:17:05.689162 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m18:17:05.689162 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:05.689162 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:17:05.689162 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m18:17:05.689162 [debug] [Thread-2 (]: Began running node test.telegram_data.my_test
[0m18:17:05.702177 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m18:17:05.702594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m18:17:05.702594 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m18:17:05.702594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now test.telegram_data.my_test)
[0m18:17:05.702594 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:05.702594 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:17:05.702594 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m18:17:05.702594 [debug] [Thread-2 (]: Began compiling node test.telegram_data.my_test
[0m18:17:05.723816 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:17:05.729749 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:17:05.733173 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m18:17:05.733764 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m18:17:05.734806 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:05.735802 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:17:05.736799 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m18:17:05.737797 [debug] [Thread-2 (]: Began executing node test.telegram_data.my_test
[0m18:17:05.738795 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:17:05.739797 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m18:17:05.741433 [debug] [Thread-2 (]: Finished running node test.telegram_data.my_test
[0m18:17:05.742495 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:17:05.743540 [debug] [Thread-3 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:17:05.744936 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_second_dbt_model, now test.telegram_data.not_null_my_second_dbt_model_id.151b76d778)
[0m18:17:05.745718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:17:05.746375 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:17:05.747065 [debug] [Thread-3 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:17:05.751304 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:17:05.751304 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:17:05.751304 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:17:05.751304 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:17:05.751304 [debug] [Thread-3 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:17:05.751304 [debug] [Thread-3 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:17:05.751304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:05.751304 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m18:17:05.751304 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:17:05.751304 [debug] [MainThread]: Connection 'test.telegram_data.my_test' was properly closed.
[0m18:17:05.751304 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:17:05.751304 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:17:05.766927 [debug] [MainThread]: Command end result
[0m18:17:09.159124 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:17:09.159644 [info ] [MainThread]: Building catalog
[0m18:17:09.171661 [debug] [ThreadPool]: Acquiring new postgres connection 'Telegram_data.information_schema'
[0m18:17:09.178105 [debug] [ThreadPool]: Using postgres connection "Telegram_data.information_schema"
[0m18:17:09.178105 [debug] [ThreadPool]: On Telegram_data.information_schema: BEGIN
[0m18:17:09.184087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:09.330592 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m18:17:09.330592 [debug] [ThreadPool]: Using postgres connection "Telegram_data.information_schema"
[0m18:17:09.330592 [debug] [ThreadPool]: On Telegram_data.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "Telegram_data.information_schema"} */

    
    

    select
        'Telegram_data' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_telegram_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('select_all')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:17:09.717529 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.394 seconds
[0m18:17:09.756091 [debug] [ThreadPool]: On Telegram_data.information_schema: ROLLBACK
[0m18:17:09.757100 [debug] [ThreadPool]: On Telegram_data.information_schema: Close
[0m18:17:09.804369 [info ] [MainThread]: Catalog written to C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data\target\catalog.json
[0m18:17:09.807348 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:17:09.807348 after 5.13 seconds
[0m18:17:09.807348 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:17:09.808323 [debug] [MainThread]: Connection 'Telegram_data.information_schema' was properly closed.
[0m18:17:09.808323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C2371090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C20E2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218C20E2E90>]}
[0m18:17:09.809304 [debug] [MainThread]: Flushing usage events
[0m18:17:10.988329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:31.958190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430BE1E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430BE4B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430BE49C10>]}


============================== 18:17:31.958190 | b22799de-0906-456f-ac21-4608a5dc5393 ==============================
[0m18:17:31.958190 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:31.958190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:17:32.148448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b22799de-0906-456f-ac21-4608a5dc5393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430C14E210>]}
[0m18:17:32.194756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b22799de-0906-456f-ac21-4608a5dc5393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243092747D0>]}
[0m18:21:30.165121 [error] [MainThread]: Encountered an error:

[0m18:21:30.476577 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:21:30.483362 [debug] [MainThread]: Command `dbt docs serve` failed at 18:21:30.483362 after 238.59 seconds
[0m18:21:30.484380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430BE6CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430C2B7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002430BE1DFD0>]}
[0m18:21:30.485354 [debug] [MainThread]: Flushing usage events
[0m18:21:31.685298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:06:41.670633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB2D2AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB2D81AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB2D817D0>]}


============================== 19:06:41.703318 | dd94122b-4ff6-4897-b383-27851a4fa174 ==============================
[0m19:06:41.703318 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:06:41.703318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:06:42.880854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd94122b-4ff6-4897-b383-27851a4fa174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB309BF10>]}
[0m19:06:42.928176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd94122b-4ff6-4897-b383-27851a4fa174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB0184E90>]}
[0m19:06:42.928176 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:06:42.943787 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:06:43.240513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:06:43.240513 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\telegram_summary.sql
[0m19:06:43.240513 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\schema.yml
[0m19:06:43.252027 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\select_all.sql
[0m19:06:43.521252 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:06:43.521252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dd94122b-4ff6-4897-b383-27851a4fa174', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB332B290>]}
[0m19:06:43.654502 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_data.telegram_summary' (models\telegram_summary.sql) depends on a node named 'transformed_telegram_data' which was not found
[0m19:06:43.662423 [debug] [MainThread]: Command `dbt run` failed at 19:06:43.662423 after 2.07 seconds
[0m19:06:43.663592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFAC7184D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFB2D63290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AFACA810D0>]}
[0m19:06:43.664173 [debug] [MainThread]: Flushing usage events
[0m19:06:44.589359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:09.417212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9C2C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9C837D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9C80AD0>]}


============================== 19:08:09.422641 | 47da32dc-ce6d-429b-a158-f005dd9a5d72 ==============================
[0m19:08:09.422641 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:08:09.424240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:08:09.610404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9F49C10>]}
[0m19:08:09.648164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF7084890>]}
[0m19:08:09.663785 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:08:09.663785 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:08:09.933342 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m19:08:09.933342 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\telegram_summary.sql
[0m19:08:09.933342 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\schema.yml
[0m19:08:09.933342 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\transformed_telegram_data.sql
[0m19:08:09.933342 [debug] [MainThread]: Partial parsing: deleted file: telegram_data://models\select_all.sql
[0m19:08:10.216052 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:08:10.216052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9F51FD0>]}
[0m19:08:10.310299 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.telegram_data.my_test' (tests\my_test.sql) depends on a node named 'select_all' in package '' which was not found
[0m19:08:10.413806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF9F6E610>]}
[0m19:08:11.640725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB58CF90>]}
[0m19:08:11.641306 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:08:11.643635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFA3C73D0>]}
[0m19:08:11.645984 [info ] [MainThread]: 
[0m19:08:11.648222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:08:11.670658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:08:12.866222 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:08:12.866222 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:08:12.866222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:13.243683 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.373 seconds
[0m19:08:13.243683 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:08:13.243683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:08:13.259077 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:08:13.259077 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:08:13.259077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:13.338915 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m19:08:13.338915 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:08:13.338915 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:08:13.432924 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.091 seconds
[0m19:08:13.432924 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:08:13.432924 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:08:13.432924 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:13.432924 [debug] [MainThread]: On master: BEGIN
[0m19:08:13.448624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:13.480293 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m19:08:13.480293 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:13.480293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:08:13.543702 [debug] [MainThread]: SQL status: SELECT 2 in 0.052 seconds
[0m19:08:13.543702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB4C3190>]}
[0m19:08:13.543702 [debug] [MainThread]: On master: ROLLBACK
[0m19:08:13.543702 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:13.543702 [debug] [MainThread]: On master: BEGIN
[0m19:08:13.543702 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:08:13.543702 [debug] [MainThread]: On master: COMMIT
[0m19:08:13.543702 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:13.543702 [debug] [MainThread]: On master: COMMIT
[0m19:08:13.543702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:08:13.559077 [debug] [MainThread]: On master: Close
[0m19:08:13.559077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:08:13.559077 [info ] [MainThread]: 
[0m19:08:13.636750 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:08:13.637746 [debug] [Thread-2 (]: Began running node model.telegram_data.transformed_telegram_data
[0m19:08:13.638886 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:08:13.640521 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:08:13.639660 [info ] [Thread-2 (]: 2 of 4 START sql view model public.transformed_telegram_data ................... [RUN]
[0m19:08:13.641522 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:08:13.643516 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.transformed_telegram_data'
[0m19:08:13.650490 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:08:13.651487 [debug] [Thread-2 (]: Began compiling node model.telegram_data.transformed_telegram_data
[0m19:08:13.656262 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.transformed_telegram_data"
[0m19:08:13.657281 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:08:13.702253 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:08:13.703257 [debug] [Thread-2 (]: Began executing node model.telegram_data.transformed_telegram_data
[0m19:08:13.729881 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.transformed_telegram_data"
[0m19:08:13.730878 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:13.731875 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:08:13.732871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:13.733868 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:08:13.734865 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: BEGIN
[0m19:08:13.735874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:08:13.800708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m19:08:13.800708 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:13.800708 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:08:13.893736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.161 seconds
[0m19:08:13.893736 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:08:13.893736 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */

  create view "Telegram_data"."public"."transformed_telegram_data__dbt_tmp"
    
    
  as (
    with source_data as (
    select 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    from "Telegram_data"."public"."transformed_telegram_data"
)

select * from source_data;
  );
[0m19:08:14.135888 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: select * from source_data;
                                  ^

[0m19:08:14.135888 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: ROLLBACK
[0m19:08:14.135888 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: Close
[0m19:08:14.382986 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.579 seconds
[0m19:08:14.392770 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:14.392770 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:08:14.392770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:08:14.403781 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:14.403781 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:08:14.403781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:08:14.435178 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:08:14.466923 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:14.466923 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:08:14.530309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.064 seconds
[0m19:08:14.546724 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:08:14.546724 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:08:14.561731 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:08:14.653900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.090 seconds
[0m19:08:14.656344 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:08:14.658338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB867790>]}
[0m19:08:14.659331 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 1.02s]
[0m19:08:14.661324 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:08:14.662356 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:08:14.663317 [info ] [Thread-4 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:08:14.664372 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m19:08:14.664372 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:08:14.667366 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:08:14.669133 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:08:14.676167 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:08:14.678108 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:08:14.679147 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:08:14.680101 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:08:14.723378 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m19:08:14.724414 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:08:14.724414 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:08:14.784325 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m19:08:14.819880 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:08:14.831391 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:08:14.847186 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m19:08:14.847186 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:08:14.847186 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:08:14.847186 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:08:14.862743 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m19:08:14.862743 [debug] [Thread-4 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:08:14.862743 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:08:14.862743 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:08:14.862743 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:08:14.862743 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:08:14.862743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFBA55190>]}
[0m19:08:14.862743 [info ] [Thread-4 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m19:08:14.862743 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:08:15.113860 [debug] [Thread-2 (]: Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 19: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:08:15.113860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47da32dc-ce6d-429b-a158-f005dd9a5d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFA3EC4D0>]}
[0m19:08:15.113860 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.transformed_telegram_data .......... [[31mERROR[0m in 1.47s]
[0m19:08:15.113860 [debug] [Thread-2 (]: Finished running node model.telegram_data.transformed_telegram_data
[0m19:08:15.120412 [debug] [Thread-1 (]: Began running node model.telegram_data.telegram_summary
[0m19:08:15.120412 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:08:15.120412 [debug] [Thread-1 (]: Finished running node model.telegram_data.telegram_summary
[0m19:08:15.124662 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:15.125655 [debug] [MainThread]: On master: BEGIN
[0m19:08:15.125655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:08:15.271158 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m19:08:15.271158 [debug] [MainThread]: On master: COMMIT
[0m19:08:15.271158 [debug] [MainThread]: Using postgres connection "master"
[0m19:08:15.271158 [debug] [MainThread]: On master: COMMIT
[0m19:08:15.271158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:08:15.271158 [debug] [MainThread]: On master: Close
[0m19:08:15.271158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:15.271158 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:08:15.271158 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:08:15.271158 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:08:15.271158 [debug] [MainThread]: Connection 'model.telegram_data.transformed_telegram_data' was properly closed.
[0m19:08:15.271158 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:08:15.271158 [info ] [MainThread]: 
[0m19:08:15.271158 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m19:08:15.271158 [debug] [MainThread]: Command end result
[0m19:08:15.360822 [info ] [MainThread]: 
[0m19:08:15.362804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:08:15.364799 [info ] [MainThread]: 
[0m19:08:15.365794 [error] [MainThread]:   Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 19: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:08:15.367793 [info ] [MainThread]: 
[0m19:08:15.369782 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:08:15.372816 [debug] [MainThread]: Command `dbt run` failed at 19:08:15.371816 after 6.10 seconds
[0m19:08:15.373765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF35D84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF36B3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF36B2F10>]}
[0m19:08:15.373765 [debug] [MainThread]: Flushing usage events
[0m19:08:17.006347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:44.850003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BBBE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BBF19D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BBBE710>]}


============================== 19:12:44.850003 | df9d8728-0529-4ee5-8b3a-5683b31fd9e5 ==============================
[0m19:12:44.850003 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:12:44.850003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:12:45.040337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BF35B50>]}
[0m19:12:45.087220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025809014610>]}
[0m19:12:45.087220 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:12:45.087220 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:12:45.268631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:12:45.268631 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\transformed_telegram_data.sql
[0m19:12:45.472513 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:12:45.472513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580C243E90>]}
[0m19:12:45.655121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580C1D77D0>]}
[0m19:12:45.781177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580D4F1AD0>]}
[0m19:12:45.781177 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:12:45.781177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580C37D090>]}
[0m19:12:45.781177 [info ] [MainThread]: 
[0m19:12:45.781177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:12:45.803611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:12:45.878971 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:12:45.878971 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:12:45.879933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:45.923507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m19:12:45.923507 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:12:45.923507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:12:45.923507 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:12:45.923507 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:12:45.939129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:45.970478 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m19:12:45.970478 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:12:45.970478 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:12:45.986105 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m19:12:45.986105 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:12:45.986105 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:12:45.986105 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:45.986105 [debug] [MainThread]: On master: BEGIN
[0m19:12:45.986105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:12:46.033289 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m19:12:46.033289 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:46.033289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:12:46.050637 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m19:12:46.050637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580C27D550>]}
[0m19:12:46.050637 [debug] [MainThread]: On master: ROLLBACK
[0m19:12:46.057237 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:46.057237 [debug] [MainThread]: On master: BEGIN
[0m19:12:46.058279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:12:46.059275 [debug] [MainThread]: On master: COMMIT
[0m19:12:46.059275 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:46.060230 [debug] [MainThread]: On master: COMMIT
[0m19:12:46.060230 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:12:46.061229 [debug] [MainThread]: On master: Close
[0m19:12:46.062224 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:46.063222 [info ] [MainThread]: 
[0m19:12:46.069087 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:12:46.069087 [debug] [Thread-2 (]: Began running node model.telegram_data.transformed_telegram_data
[0m19:12:46.070479 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:12:46.070996 [info ] [Thread-2 (]: 2 of 4 START sql view model public.transformed_telegram_data ................... [RUN]
[0m19:12:46.072165 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:12:46.073831 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.transformed_telegram_data'
[0m19:12:46.074859 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:12:46.075829 [debug] [Thread-2 (]: Began compiling node model.telegram_data.transformed_telegram_data
[0m19:12:46.077095 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:12:46.077095 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.transformed_telegram_data"
[0m19:12:46.077095 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:12:46.107063 [debug] [Thread-2 (]: Began executing node model.telegram_data.transformed_telegram_data
[0m19:12:46.127074 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:12:46.142741 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.transformed_telegram_data"
[0m19:12:46.142741 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.142741 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:12:46.142741 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:12:46.142741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:46.157231 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: BEGIN
[0m19:12:46.159229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:12:46.207738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m19:12:46.207738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m19:12:46.207738 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.207738 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:12:46.207738 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:12:46.207738 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */

  create view "Telegram_data"."public"."transformed_telegram_data__dbt_tmp"
    
    
  as (
    -- models/transformed_telegram_data.sql

with source_data as (
    select 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    from "Telegram_data"."public"."transformed_telegram_data"
)

select * from source_data;
  );
[0m19:12:46.215217 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from source_data;
                                  ^

[0m19:12:46.215217 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: ROLLBACK
[0m19:12:46.215217 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: Close
[0m19:12:46.223725 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m19:12:46.225292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.239796 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:12:46.240372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:46.245579 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.245579 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:12:46.250732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:46.253684 [debug] [Thread-2 (]: Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 21: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:12:46.286783 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:12:46.286783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580D840990>]}
[0m19:12:46.286783 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.292698 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.transformed_telegram_data .......... [[31mERROR[0m in 0.21s]
[0m19:12:46.292698 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:12:46.292698 [debug] [Thread-2 (]: Finished running node model.telegram_data.transformed_telegram_data
[0m19:12:46.292698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:12:46.292698 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:12:46.312842 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:12:46.312842 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:12:46.316829 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:12:46.316829 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:12:46.316829 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:12:46.325579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:12:46.328448 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:12:46.329432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580DCDD690>]}
[0m19:12:46.331439 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.26s]
[0m19:12:46.333011 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:12:46.334010 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:12:46.335007 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:12:46.336012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.transformed_telegram_data, now model.telegram_data.my_second_dbt_model)
[0m19:12:46.337000 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:12:46.340265 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:12:46.342263 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:12:46.347102 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:12:46.349037 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:12:46.349037 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:12:46.350034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:12:46.393426 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m19:12:46.393426 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:12:46.393426 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:12:46.393426 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:12:46.404930 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:12:46.406907 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:12:46.407934 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:12:46.410898 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:12:46.410898 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:12:46.411895 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:12:46.413904 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:12:46.417878 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:12:46.420867 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:12:46.421864 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:12:46.422868 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:12:46.426044 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:12:46.426992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9d8728-0529-4ee5-8b3a-5683b31fd9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580D874210>]}
[0m19:12:46.428053 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:12:46.430049 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:12:46.432042 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:46.432042 [debug] [MainThread]: On master: BEGIN
[0m19:12:46.433039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:12:46.534324 [debug] [MainThread]: SQL status: BEGIN in 0.102 seconds
[0m19:12:46.535364 [debug] [MainThread]: On master: COMMIT
[0m19:12:46.535364 [debug] [MainThread]: Using postgres connection "master"
[0m19:12:46.536322 [debug] [MainThread]: On master: COMMIT
[0m19:12:46.536322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:12:46.537372 [debug] [MainThread]: On master: Close
[0m19:12:46.537372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:46.538357 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:12:46.539331 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:12:46.540309 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:12:46.540309 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:12:46.541305 [info ] [MainThread]: 
[0m19:12:46.541305 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m19:12:46.541305 [debug] [MainThread]: Command end result
[0m19:12:46.626629 [info ] [MainThread]: 
[0m19:12:46.628677 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:12:46.629623 [info ] [MainThread]: 
[0m19:12:46.630648 [error] [MainThread]:   Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 21: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:12:46.632611 [info ] [MainThread]: 
[0m19:12:46.633803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:12:46.635812 [debug] [MainThread]: Command `dbt run` failed at 19:12:46.635812 after 1.91 seconds
[0m19:12:46.637267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258055D84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC270D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC26E50>]}
[0m19:12:46.637881 [debug] [MainThread]: Flushing usage events
[0m19:12:46.941706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:26.707699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D43EEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D441B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D441B810>]}


============================== 19:18:26.707699 | 9e8fdc0c-3c3f-4385-b5de-9a1c68f1a239 ==============================
[0m19:18:26.707699 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:26.707699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:26.907525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e8fdc0c-3c3f-4385-b5de-9a1c68f1a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D4755E50>]}
[0m19:18:26.970354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e8fdc0c-3c3f-4385-b5de-9a1c68f1a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D1844950>]}
[0m19:18:26.970354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:18:26.970354 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:18:27.159231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m19:18:27.159231 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\src_telegram_data.yml
[0m19:18:27.159231 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\transformed_telegram_data.sql
[0m19:18:27.175509 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\telegram_summary.sql
[0m19:18:27.411420 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "Telegram_data_transformed_telegram_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("Telegram_data", "transformed_telegram_data").
  
  To fix this, change the name of one of these resources:
  - source.telegram_data.Telegram_data.transformed_telegram_data (models\src_telegram_data.yml)
  - source.telegram_data.Telegram_data.transformed_telegram_data (models\sources\source_transformed_data.yml)
[0m19:18:27.442668 [debug] [MainThread]: Command `dbt run` failed at 19:18:27.442668 after 0.97 seconds
[0m19:18:27.442668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D43EDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130CDD984D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D41C2B90>]}
[0m19:18:27.442668 [debug] [MainThread]: Flushing usage events
[0m19:18:28.767244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:02.200261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE60313950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE602ED810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE60310AD0>]}


============================== 19:20:02.200261 | 813201f6-07af-46eb-b7d6-39d6b4885d19 ==============================
[0m19:20:02.200261 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:02.200261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:02.423960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE600C2890>]}
[0m19:20:02.473881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5D714910>]}
[0m19:20:02.473881 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:20:02.489095 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:20:02.629227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:20:02.644801 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\telegram_summary.sql
[0m19:20:02.646862 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\transformed_telegram_data.sql
[0m19:20:02.833502 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:20:02.833502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE60966410>]}
[0m19:20:03.028650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE61A8DE50>]}
[0m19:20:03.147287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE61B60A50>]}
[0m19:20:03.147287 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:20:03.147287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE60A0B5D0>]}
[0m19:20:03.156792 [info ] [MainThread]: 
[0m19:20:03.156792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:20:03.156792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:20:03.231705 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:20:03.231705 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:20:03.231705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:03.392972 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.160 seconds
[0m19:20:03.392972 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:20:03.392972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:20:03.408607 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:20:03.408607 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:20:03.408607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:03.447839 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m19:20:03.447839 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:20:03.447839 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:20:03.455904 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m19:20:03.455904 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:20:03.455904 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:20:03.471579 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:03.471579 [debug] [MainThread]: On master: BEGIN
[0m19:20:03.471579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:03.518847 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m19:20:03.518847 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:03.518847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:20:03.535470 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m19:20:03.535470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5D7165D0>]}
[0m19:20:03.535470 [debug] [MainThread]: On master: ROLLBACK
[0m19:20:03.535470 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:03.535470 [debug] [MainThread]: On master: BEGIN
[0m19:20:03.535470 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:20:03.535470 [debug] [MainThread]: On master: COMMIT
[0m19:20:03.535470 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:03.535470 [debug] [MainThread]: On master: COMMIT
[0m19:20:03.535470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:03.535470 [debug] [MainThread]: On master: Close
[0m19:20:03.535470 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:03.535470 [info ] [MainThread]: 
[0m19:20:03.553048 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:20:03.553048 [debug] [Thread-2 (]: Began running node model.telegram_data.transformed_telegram_data
[0m19:20:03.554049 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:20:03.556130 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:20:03.554968 [info ] [Thread-2 (]: 2 of 4 START sql view model public.transformed_telegram_data ................... [RUN]
[0m19:20:03.557131 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:20:03.559177 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.transformed_telegram_data'
[0m19:20:03.567324 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:20:03.567324 [debug] [Thread-2 (]: Began compiling node model.telegram_data.transformed_telegram_data
[0m19:20:03.567324 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.transformed_telegram_data"
[0m19:20:03.567324 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:20:03.581276 [debug] [Thread-2 (]: Began executing node model.telegram_data.transformed_telegram_data
[0m19:20:03.617312 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:20:03.636946 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.transformed_telegram_data"
[0m19:20:03.639058 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.640054 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:20:03.641050 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:20:03.642048 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:03.643044 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: BEGIN
[0m19:20:03.644041 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:20:03.681296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m19:20:03.681296 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:20:03.681296 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */

  create view "Telegram_data"."public"."transformed_telegram_data__dbt_tmp"
    
    
  as (
    -- models/transformed_telegram_data.sql

with source_data as (
    select 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    from "Telegram_data"."public"."transformed_telegram_data" 
)

select * from source_data;
  );
[0m19:20:03.681296 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from source_data;
                                  ^

[0m19:20:03.681296 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: ROLLBACK
[0m19:20:03.681296 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: Close
[0m19:20:03.696303 [debug] [Thread-2 (]: Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 21: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:20:03.696303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE60913650>]}
[0m19:20:03.696303 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.transformed_telegram_data .......... [[31mERROR[0m in 0.14s]
[0m19:20:03.696303 [debug] [Thread-2 (]: Finished running node model.telegram_data.transformed_telegram_data
[0m19:20:03.696303 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:20:03.696303 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:20:03.708543 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:20:03.801015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m19:20:03.802057 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.802057 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:20:03.807614 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:20:03.814698 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.815766 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:20:03.832166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m19:20:03.832166 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.832166 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:20:03.832166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:20:03.848328 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:20:03.848328 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.863831 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:20:03.863831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:20:03.863831 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:20:03.863831 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:20:03.863831 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:20:03.879548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m19:20:03.879548 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:20:03.895140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE623BBD90>]}
[0m19:20:03.895140 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.34s]
[0m19:20:03.895140 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:20:03.895140 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:20:03.895140 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:20:03.895140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.transformed_telegram_data, now model.telegram_data.my_second_dbt_model)
[0m19:20:03.895140 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:20:03.908784 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:20:03.909778 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:20:03.915485 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:20:03.917816 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:20:03.918855 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:20:03.918855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:20:04.065996 [debug] [Thread-2 (]: SQL status: BEGIN in 0.147 seconds
[0m19:20:04.067053 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:20:04.067053 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:20:04.072879 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:20:04.075871 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:20:04.075871 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:20:04.077568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:20:04.079564 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:20:04.079564 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:20:04.080561 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:20:04.081122 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:20:04.081122 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:20:04.081122 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:20:04.081122 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:20:04.081122 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:20:04.081122 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:20:04.081122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '813201f6-07af-46eb-b7d6-39d6b4885d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE61F8AAD0>]}
[0m19:20:04.081122 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.19s]
[0m19:20:04.081122 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:20:04.096627 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:04.096627 [debug] [MainThread]: On master: BEGIN
[0m19:20:04.096627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:04.136809 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m19:20:04.136809 [debug] [MainThread]: On master: COMMIT
[0m19:20:04.136809 [debug] [MainThread]: Using postgres connection "master"
[0m19:20:04.136809 [debug] [MainThread]: On master: COMMIT
[0m19:20:04.136809 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:20:04.136809 [debug] [MainThread]: On master: Close
[0m19:20:04.136809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:04.136809 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:20:04.136809 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:20:04.147729 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:20:04.148973 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:20:04.149610 [info ] [MainThread]: 
[0m19:20:04.149610 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m19:20:04.149610 [debug] [MainThread]: Command end result
[0m19:20:04.231115 [info ] [MainThread]: 
[0m19:20:04.233112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:20:04.234110 [info ] [MainThread]: 
[0m19:20:04.235170 [error] [MainThread]:   Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  syntax error at or near ";"
  LINE 21: select * from source_data;
                                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:20:04.237470 [info ] [MainThread]: 
[0m19:20:04.238466 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:20:04.241660 [debug] [MainThread]: Command `dbt run` failed at 19:20:04.240462 after 2.10 seconds
[0m19:20:04.242301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE59CE84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE59DC3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE59DC3B90>]}
[0m19:20:04.243302 [debug] [MainThread]: Flushing usage events
[0m19:20:08.270527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:10.176660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B4E2EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B4E2EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B4E2D950>]}


============================== 19:28:10.188163 | ce1cf500-f7b4-4ccb-b04f-1386189029cf ==============================
[0m19:28:10.188163 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:28:10.188163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:28:10.369789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B51A8190>]}
[0m19:28:10.419010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B22846D0>]}
[0m19:28:10.419010 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:28:10.419010 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:28:10.601773 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:28:10.601773 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\sources\source.yml
[0m19:28:10.601773 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\transformed_telegram_data.sql
[0m19:28:10.862461 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:28:10.878085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B659F250>]}
[0m19:28:11.083760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B66B4950>]}
[0m19:28:11.210773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B54C7BD0>]}
[0m19:28:11.220276 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:28:11.220276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B533EAD0>]}
[0m19:28:11.223784 [info ] [MainThread]: 
[0m19:28:11.224765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:11.229414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:28:11.307285 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:28:11.307285 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:28:11.307285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:11.357147 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m19:28:11.357147 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:28:11.357147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:28:11.357147 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:28:11.357147 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:28:11.357147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:11.452110 [debug] [ThreadPool]: SQL status: BEGIN in 0.083 seconds
[0m19:28:11.452110 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:28:11.452110 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:11.467495 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m19:28:11.467495 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:28:11.467495 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:28:11.467495 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:11.467495 [debug] [MainThread]: On master: BEGIN
[0m19:28:11.467495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:11.520908 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m19:28:11.520908 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:11.520908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:11.530412 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m19:28:11.530412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B657A490>]}
[0m19:28:11.530412 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:11.530412 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:11.530412 [debug] [MainThread]: On master: BEGIN
[0m19:28:11.530412 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:28:11.530412 [debug] [MainThread]: On master: COMMIT
[0m19:28:11.530412 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:11.530412 [debug] [MainThread]: On master: COMMIT
[0m19:28:11.530412 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:28:11.530412 [debug] [MainThread]: On master: Close
[0m19:28:11.530412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:11.530412 [info ] [MainThread]: 
[0m19:28:11.546041 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:28:11.546041 [debug] [Thread-2 (]: Began running node model.telegram_data.transformed_telegram_data
[0m19:28:11.546041 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:28:11.546041 [info ] [Thread-2 (]: 2 of 4 START sql view model public.transformed_telegram_data ................... [RUN]
[0m19:28:11.555333 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:28:11.557329 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.transformed_telegram_data'
[0m19:28:11.558325 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:28:11.559321 [debug] [Thread-2 (]: Began compiling node model.telegram_data.transformed_telegram_data
[0m19:28:11.566346 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:28:11.569323 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.transformed_telegram_data"
[0m19:28:11.571284 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:28:11.589437 [debug] [Thread-2 (]: Began executing node model.telegram_data.transformed_telegram_data
[0m19:28:11.607111 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:28:11.635042 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.transformed_telegram_data"
[0m19:28:11.637005 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.637005 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:28:11.637978 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.638980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:11.639874 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: BEGIN
[0m19:28:11.640952 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:28:11.672639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:28:11.672639 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.672639 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:28:11.672639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m19:28:11.672639 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.672639 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */

  create view "Telegram_data"."public"."transformed_telegram_data__dbt_tmp"
    
    
  as (
    -- models/transformed_telegram_data.sql

with source_data as (
    select 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    from "Telegram_data"."public"."transformed_telegram_data" 
)

select 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
from source_data
  );
[0m19:28:11.688261 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m19:28:11.688261 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.688261 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:28:11.688261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:28:11.688261 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.703933 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:28:11.742165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:28:11.756362 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:28:11.756362 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.756362 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:28:11.772198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m19:28:11.772198 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:28:11.787653 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:28:11.787653 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.105 seconds
[0m19:28:11.787653 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:28:11.787653 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.787653 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */
alter table "Telegram_data"."public"."transformed_telegram_data" rename to "transformed_telegram_data__dbt_backup"
[0m19:28:11.787653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:28:11.787653 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.787653 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */
alter table "Telegram_data"."public"."transformed_telegram_data__dbt_tmp" rename to "transformed_telegram_data"
[0m19:28:11.803244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:28:11.803244 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: COMMIT
[0m19:28:11.803244 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.803244 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: COMMIT
[0m19:28:11.803244 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m19:28:11.803244 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."transformed_telegram_data__dbt_backup"
[0m19:28:11.803244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m19:28:11.803244 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:28:11.818896 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:28:11.818896 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */
drop table if exists "Telegram_data"."public"."transformed_telegram_data__dbt_backup" cascade
[0m19:28:11.821402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B6C24A90>]}
[0m19:28:11.821402 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m19:28:11.821402 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:28:11.821402 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:28:11.821402 [info ] [Thread-4 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:28:11.821402 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m19:28:11.821402 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:28:11.821402 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:28:11.821402 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:28:11.840568 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:28:11.842435 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:28:11.843440 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:28:11.844430 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:28:11.956709 [debug] [Thread-4 (]: SQL status: BEGIN in 0.112 seconds
[0m19:28:11.956709 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:28:11.956709 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:28:11.956709 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:28:12.003628 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:28:12.003628 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:28:12.003628 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:28:12.003628 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:28:12.003628 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:28:12.003628 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:28:12.003628 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m19:28:12.021813 [debug] [Thread-4 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:28:12.021813 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:28:12.021813 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:28:12.021813 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:28:12.021813 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:28:12.021813 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B704C350>]}
[0m19:28:12.021813 [info ] [Thread-4 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m19:28:12.021813 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:28:12.073966 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.250 seconds
[0m19:28:12.073966 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: Close
[0m19:28:12.073966 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B6B2CD90>]}
[0m19:28:12.073966 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.transformed_telegram_data .............. [[32mCREATE VIEW[0m in 0.52s]
[0m19:28:12.073966 [debug] [Thread-2 (]: Finished running node model.telegram_data.transformed_telegram_data
[0m19:28:12.073966 [debug] [Thread-1 (]: Began running node model.telegram_data.telegram_summary
[0m19:28:12.073966 [info ] [Thread-1 (]: 4 of 4 START sql view model public.telegram_summary ............................ [RUN]
[0m19:28:12.073966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now model.telegram_data.telegram_summary)
[0m19:28:12.084413 [debug] [Thread-1 (]: Began compiling node model.telegram_data.telegram_summary
[0m19:28:12.087444 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.telegram_summary"
[0m19:28:12.089477 [debug] [Thread-1 (]: Began executing node model.telegram_data.telegram_summary
[0m19:28:12.097074 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.telegram_summary"
[0m19:28:12.098373 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m19:28:12.099373 [debug] [Thread-1 (]: On model.telegram_data.telegram_summary: BEGIN
[0m19:28:12.099373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:12.147025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:28:12.148048 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m19:28:12.149049 [debug] [Thread-1 (]: On model.telegram_data.telegram_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.telegram_summary"} */

  create view "Telegram_data"."public"."telegram_summary__dbt_tmp"
    
    
  as (
    -- models/telegram_summary.sql

with transformed_data as (
    select * from "Telegram_data"."public"."transformed_telegram_data" 
)

select
    channel_name,
    count(message_id) as total_messages,
    max(timestamp) as latest_message
from transformed_data
group by channel_name;
  );
[0m19:28:12.151042 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: group by channel_name;
                              ^

[0m19:28:12.151042 [debug] [Thread-1 (]: On model.telegram_data.telegram_summary: ROLLBACK
[0m19:28:12.153036 [debug] [Thread-1 (]: On model.telegram_data.telegram_summary: Close
[0m19:28:12.160350 [debug] [Thread-1 (]: Database Error in model telegram_summary (models\telegram_summary.sql)
  syntax error at or near ";"
  LINE 18: group by channel_name;
                                ^
  compiled code at target\run\telegram_data\models\telegram_summary.sql
[0m19:28:12.161282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce1cf500-f7b4-4ccb-b04f-1386189029cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B704C410>]}
[0m19:28:12.161282 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model public.telegram_summary ................... [[31mERROR[0m in 0.09s]
[0m19:28:12.163275 [debug] [Thread-1 (]: Finished running node model.telegram_data.telegram_summary
[0m19:28:12.166333 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:12.166333 [debug] [MainThread]: On master: BEGIN
[0m19:28:12.167259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:12.211428 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m19:28:12.211428 [debug] [MainThread]: On master: COMMIT
[0m19:28:12.211428 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:12.211428 [debug] [MainThread]: On master: COMMIT
[0m19:28:12.211428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:28:12.211428 [debug] [MainThread]: On master: Close
[0m19:28:12.211428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:12.211428 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:28:12.211428 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:28:12.211428 [debug] [MainThread]: Connection 'model.telegram_data.telegram_summary' was properly closed.
[0m19:28:12.211428 [debug] [MainThread]: Connection 'model.telegram_data.transformed_telegram_data' was properly closed.
[0m19:28:12.211428 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:28:12.211428 [info ] [MainThread]: 
[0m19:28:12.222666 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m19:28:12.224468 [debug] [MainThread]: Command end result
[0m19:28:12.261071 [info ] [MainThread]: 
[0m19:28:12.262227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:28:12.262227 [info ] [MainThread]: 
[0m19:28:12.262227 [error] [MainThread]:   Database Error in model telegram_summary (models\telegram_summary.sql)
  syntax error at or near ";"
  LINE 18: group by channel_name;
                                ^
  compiled code at target\run\telegram_data\models\telegram_summary.sql
[0m19:28:12.267361 [info ] [MainThread]: 
[0m19:28:12.268264 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:28:12.270166 [debug] [MainThread]: Command `dbt run` failed at 19:28:12.270166 after 2.16 seconds
[0m19:28:12.271209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175AE7D84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B4E94D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175B4E96DD0>]}
[0m19:28:12.271209 [debug] [MainThread]: Flushing usage events
[0m19:28:12.522598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:41.516245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B59D37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B5782A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B597A290>]}


============================== 19:30:41.516245 | ba510c08-7495-429d-95b7-70857390728b ==============================
[0m19:30:41.516245 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:30:41.516245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:30:41.706641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B5CA1B10>]}
[0m19:30:41.763026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B2DD4CD0>]}
[0m19:30:41.763026 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:30:41.769587 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:30:41.941599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:41.941599 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\transformed_telegram_data.sql
[0m19:30:42.181525 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:30:42.183766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B6020310>]}
[0m19:30:42.354545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B5FCA810>]}
[0m19:30:42.474917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B715BB90>]}
[0m19:30:42.474917 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:30:42.474917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B7237710>]}
[0m19:30:42.474917 [info ] [MainThread]: 
[0m19:30:42.489003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:42.489003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:30:42.577360 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:30:42.578340 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:30:42.579279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:42.624927 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m19:30:42.624927 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:30:42.624927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:30:42.624927 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:30:42.624927 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:30:42.624927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:42.672085 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m19:30:42.672085 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:30:42.672085 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:30:42.687713 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:30:42.687713 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:30:42.687713 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:30:42.687713 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:42.687713 [debug] [MainThread]: On master: BEGIN
[0m19:30:42.687713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:42.734586 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m19:30:42.734586 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:42.734586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:42.750297 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m19:30:42.750297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B5F8E350>]}
[0m19:30:42.750297 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:42.750297 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:42.750297 [debug] [MainThread]: On master: BEGIN
[0m19:30:42.750297 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:30:42.750297 [debug] [MainThread]: On master: COMMIT
[0m19:30:42.750297 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:42.750297 [debug] [MainThread]: On master: COMMIT
[0m19:30:42.750297 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:42.750297 [debug] [MainThread]: On master: Close
[0m19:30:42.764807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:42.764807 [info ] [MainThread]: 
[0m19:30:42.766359 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:30:42.766359 [debug] [Thread-2 (]: Began running node model.telegram_data.transformed_telegram_data
[0m19:30:42.766359 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:30:42.766359 [info ] [Thread-2 (]: 2 of 4 START sql view model public.transformed_telegram_data ................... [RUN]
[0m19:30:42.775861 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:30:42.778105 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.transformed_telegram_data'
[0m19:30:42.779136 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:30:42.780132 [debug] [Thread-2 (]: Began compiling node model.telegram_data.transformed_telegram_data
[0m19:30:42.788496 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:30:42.794993 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.transformed_telegram_data"
[0m19:30:42.796952 [debug] [Thread-2 (]: Began executing node model.telegram_data.transformed_telegram_data
[0m19:30:42.797950 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:30:42.834498 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.transformed_telegram_data"
[0m19:30:42.855204 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:30:42.857149 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:30:42.858146 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.858146 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: BEGIN
[0m19:30:42.859401 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:30:42.859401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:30:42.859401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:42.906218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m19:30:42.906218 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.906218 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:30:42.906218 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:30:42.906218 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.921895 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:30:42.921895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:42.921895 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.921895 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:30:42.921895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:42.948447 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:30:42.948447 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.949447 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:30:42.951194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:30:42.958802 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:30:42.965310 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:30:42.965310 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:30:42.973896 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m19:30:42.973896 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:30:42.973896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B60CFC90>]}
[0m19:30:42.989526 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m19:30:42.989526 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:30:42.989526 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:30:42.989526 [info ] [Thread-4 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:30:42.989526 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m19:30:42.989526 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:30:42.989526 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:30:42.989526 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:30:42.989526 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:30:42.989526 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:30:43.005148 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:30:43.006357 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:30:43.008676 [debug] [Thread-2 (]: SQL status: BEGIN in 0.147 seconds
[0m19:30:43.009540 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.transformed_telegram_data"
[0m19:30:43.010980 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.transformed_telegram_data"} */

  create view "Telegram_data"."public"."transformed_telegram_data__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:30:43.173023 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:30:43.188653 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: ROLLBACK
[0m19:30:43.188653 [debug] [Thread-2 (]: On model.telegram_data.transformed_telegram_data: Close
[0m19:30:43.188653 [debug] [Thread-2 (]: Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:30:43.188653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B75E4CD0>]}
[0m19:30:43.188653 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.transformed_telegram_data .......... [[31mERROR[0m in 0.41s]
[0m19:30:43.188653 [debug] [Thread-2 (]: Finished running node model.telegram_data.transformed_telegram_data
[0m19:30:43.188653 [debug] [Thread-1 (]: Began running node model.telegram_data.telegram_summary
[0m19:30:43.188653 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:30:43.188653 [debug] [Thread-1 (]: Finished running node model.telegram_data.telegram_summary
[0m19:30:43.210968 [debug] [Thread-4 (]: SQL status: BEGIN in 0.217 seconds
[0m19:30:43.210968 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:30:43.210968 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:30:43.232463 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:30:43.232463 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:30:43.232463 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:30:43.232463 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:43.232463 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:30:43.232463 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:30:43.232463 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:30:43.244502 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m19:30:43.244502 [debug] [Thread-4 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:30:43.244502 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:30:43.244502 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:30:43.244502 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:30:43.244502 [debug] [Thread-4 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:30:43.244502 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba510c08-7495-429d-95b7-70857390728b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B762C750>]}
[0m19:30:43.244502 [info ] [Thread-4 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.25s]
[0m19:30:43.244502 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:30:43.259664 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:43.260603 [debug] [MainThread]: On master: BEGIN
[0m19:30:43.260603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:43.299654 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m19:30:43.299654 [debug] [MainThread]: On master: COMMIT
[0m19:30:43.299654 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:43.299654 [debug] [MainThread]: On master: COMMIT
[0m19:30:43.309582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:43.310575 [debug] [MainThread]: On master: Close
[0m19:30:43.311696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:43.311696 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:30:43.311696 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:30:43.311696 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:30:43.311696 [debug] [MainThread]: Connection 'model.telegram_data.transformed_telegram_data' was properly closed.
[0m19:30:43.311696 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:30:43.311696 [info ] [MainThread]: 
[0m19:30:43.311696 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m19:30:43.311696 [debug] [MainThread]: Command end result
[0m19:30:43.398374 [info ] [MainThread]: 
[0m19:30:43.400368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:43.401365 [info ] [MainThread]: 
[0m19:30:43.402442 [error] [MainThread]:   Database Error in model transformed_telegram_data (models\transformed_telegram_data.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\transformed_telegram_data.sql
[0m19:30:43.404154 [info ] [MainThread]: 
[0m19:30:43.405872 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:30:43.408680 [debug] [MainThread]: Command `dbt run` failed at 19:30:43.408680 after 1.96 seconds
[0m19:30:43.409684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AF3284D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B7512150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B7216310>]}
[0m19:30:43.410679 [debug] [MainThread]: Flushing usage events
[0m19:30:47.523646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:56.208844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7469AEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7469AEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7469AE450>]}


============================== 19:33:56.208844 | 1d1c384a-b608-4904-b86b-e456b2e30162 ==============================
[0m19:33:56.208844 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:33:56.208844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:33:56.406416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d1c384a-b608-4904-b86b-e456b2e30162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C746587F90>]}
[0m19:33:56.442670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d1c384a-b608-4904-b86b-e456b2e30162', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C743E04950>]}
[0m19:33:56.442670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:33:56.458293 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:33:56.625198 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:33:56.625198 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\select_all.sql
[0m19:33:56.625198 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\schema.yml
[0m19:33:56.625198 [debug] [MainThread]: Partial parsing: deleted file: telegram_data://models\transformed_telegram_data.sql
[0m19:33:56.829205 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:33:56.829205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d1c384a-b608-4904-b86b-e456b2e30162', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7470C07D0>]}
[0m19:33:56.939779 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_data.telegram_summary' (models\telegram_summary.sql) depends on a node named 'transformed_telegram_data' which was not found
[0m19:33:56.941774 [debug] [MainThread]: Command `dbt run` failed at 19:33:56.941774 after 0.86 seconds
[0m19:33:56.942805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7403584D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7470B4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C740433C90>]}
[0m19:33:56.942805 [debug] [MainThread]: Flushing usage events
[0m19:33:58.218403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:47.953282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E5EBB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E5F124D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E5F10AD0>]}


============================== 19:36:47.953282 | c9bef7f2-b949-41d2-af4d-d8ee0e2e4c84 ==============================
[0m19:36:47.953282 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:36:47.953282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:36:48.161142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bef7f2-b949-41d2-af4d-d8ee0e2e4c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E61D8C10>]}
[0m19:36:48.217406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9bef7f2-b949-41d2-af4d-d8ee0e2e4c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E3314F90>]}
[0m19:36:48.219377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:36:48.230916 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:36:48.379867 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:36:48.379867 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\select_all.sql
[0m19:36:48.395571 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\schema.yml
[0m19:36:48.395571 [debug] [MainThread]: Partial parsing: deleted file: telegram_data://models\transformed_telegram_data.sql
[0m19:36:48.584577 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:36:48.584577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c9bef7f2-b949-41d2-af4d-d8ee0e2e4c84', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E65C4110>]}
[0m19:36:48.698078 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_data.telegram_summary' (models\telegram_summary.sql) depends on a node named 'transformed_telegram_data' which was not found
[0m19:36:48.698078 [debug] [MainThread]: Command `dbt run` failed at 19:36:48.698078 after 0.88 seconds
[0m19:36:48.698078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E5F29050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286E65C4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DF8984D0>]}
[0m19:36:48.698078 [debug] [MainThread]: Flushing usage events
[0m19:36:53.628064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:03.222380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CE8D3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CDDFD1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CE87D950>]}


============================== 19:39:03.238002 | a2b5f579-20b1-4b44-a1a2-d1704e93f709 ==============================
[0m19:39:03.238002 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:39:03.238002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:03.460626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CC1068D0>]}
[0m19:39:03.506771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CBCD4790>]}
[0m19:39:03.506771 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:03.525296 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:39:03.680821 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m19:39:03.680821 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\select_all.sql
[0m19:39:03.680821 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\schema.yml
[0m19:39:03.680821 [debug] [MainThread]: Partial parsing: deleted file: telegram_data://models\transformed_telegram_data.sql
[0m19:39:03.680821 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\telegram_summary.sql
[0m19:39:03.882212 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:39:03.882212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CEF90350>]}
[0m19:39:04.047587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CF088DD0>]}
[0m19:39:04.180110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5CF07F310>]}
[0m19:39:04.180110 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:39:04.180110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D00CA010>]}
[0m19:39:04.180110 [info ] [MainThread]: 
[0m19:39:04.180110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:04.189113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:39:04.270429 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:39:04.270429 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:39:04.271391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:04.316645 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m19:39:04.332788 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:39:04.336705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:39:04.336705 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:39:04.336705 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:39:04.336705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:04.493395 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m19:39:04.493395 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:39:04.493395 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:04.493395 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:39:04.509072 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:39:04.509072 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:39:04.510644 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.510644 [debug] [MainThread]: On master: BEGIN
[0m19:39:04.510644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:04.556500 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m19:39:04.556500 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.556500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:04.556500 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m19:39:04.572040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D011C550>]}
[0m19:39:04.572040 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:04.572040 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.572040 [debug] [MainThread]: On master: BEGIN
[0m19:39:04.572040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:39:04.572040 [debug] [MainThread]: On master: COMMIT
[0m19:39:04.572040 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.572040 [debug] [MainThread]: On master: COMMIT
[0m19:39:04.572040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:04.572040 [debug] [MainThread]: On master: Close
[0m19:39:04.572040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:39:04.581046 [info ] [MainThread]: 
[0m19:39:04.581046 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:39:04.581046 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:39:04.588061 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:39:04.590764 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:39:04.591510 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:39:04.593536 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:39:04.593536 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:39:04.594571 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:39:04.605299 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:39:04.606802 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:39:04.606802 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:39:04.635962 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:39:04.652785 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:39:04.674841 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:39:04.675882 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.676786 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:39:04.677782 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:39:04.678788 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:39:04.678788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:04.679775 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:39:04.717223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:39:04.717223 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.717223 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:39:04.717223 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m19:39:04.717223 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:39:04.717223 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:39:04.717223 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:39:04.717223 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:39:04.732847 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:39:04.732847 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:39:04.732847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D04A7810>]}
[0m19:39:04.732847 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.14s]
[0m19:39:04.732847 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:39:04.732847 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:39:04.732847 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.019 seconds
[0m19:39:04.756230 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.748509 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:39:04.757222 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:39:04.758238 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:39:04.759263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:39:04.763251 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.763251 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:39:04.765246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:39:04.784639 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:39:04.784639 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.784639 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:39:04.784639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:39:04.784639 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:39:04.801412 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:39:04.801412 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:39:04.801412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:39:04.801412 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:39:04.801412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D0525B90>]}
[0m19:39:04.801412 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m19:39:04.815919 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:39:04.818179 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:39:04.818179 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:39:04.818179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:39:04.822161 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:39:04.825192 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:39:04.826202 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:39:04.828279 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:39:04.828279 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:39:04.828279 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:39:04.828279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:39:04.869098 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m19:39:04.869098 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:39:04.869098 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:39:04.885790 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:39:04.888817 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:39:04.889814 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:39:04.890765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:39:04.892759 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:39:04.892759 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:39:04.893757 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:39:04.895742 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:39:04.897789 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:39:04.901937 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:39:04.901937 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:39:04.902970 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:39:04.904909 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:39:04.904909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b5f579-20b1-4b44-a1a2-d1704e93f709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D0531550>]}
[0m19:39:04.905873 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:04.907865 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:39:04.909856 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.910853 [debug] [MainThread]: On master: BEGIN
[0m19:39:04.910853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:04.956504 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m19:39:04.956504 [debug] [MainThread]: On master: COMMIT
[0m19:39:04.956504 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:04.956504 [debug] [MainThread]: On master: COMMIT
[0m19:39:04.956504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:04.956504 [debug] [MainThread]: On master: Close
[0m19:39:04.956504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:04.956504 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:39:04.956504 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:39:04.956504 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:39:04.956504 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:39:04.956504 [info ] [MainThread]: 
[0m19:39:04.956504 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m19:39:04.968080 [debug] [MainThread]: Command end result
[0m19:39:05.046267 [info ] [MainThread]: 
[0m19:39:05.048215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:39:05.049234 [info ] [MainThread]: 
[0m19:39:05.050983 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:39:05.052836 [info ] [MainThread]: 
[0m19:39:05.054662 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:39:05.056709 [debug] [MainThread]: Command `dbt run` failed at 19:39:05.056709 after 1.89 seconds
[0m19:39:05.056709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C82B84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C8393C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C8393B10>]}
[0m19:39:05.057652 [debug] [MainThread]: Flushing usage events
[0m19:39:06.600598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:00.606503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B7FB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B829C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B7FAD50>]}


============================== 19:42:00.622091 | 334a27be-7bba-4014-805a-279eb832d1dc ==============================
[0m19:42:00.622091 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:42:00.622091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:42:00.800538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1B801B10>]}
[0m19:42:00.847955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A18C54610>]}
[0m19:42:00.847955 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:42:00.863606 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:42:01.043778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:01.050853 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\sources\source.yml
[0m19:42:01.254977 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:42:01.254977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1BB23410>]}
[0m19:42:01.572223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1BB31B10>]}
[0m19:42:01.717011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1D12F450>]}
[0m19:42:01.718198 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:42:01.718701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1CFC2910>]}
[0m19:42:01.722739 [info ] [MainThread]: 
[0m19:42:01.724259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:42:01.729846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:42:01.823398 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:42:01.823398 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:42:01.824394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:01.868111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m19:42:01.868111 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:42:01.868111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:42:01.883732 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:42:01.883732 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:42:01.883732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:01.914929 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m19:42:01.914929 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:42:01.914929 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:42:01.937277 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:42:01.939340 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:42:01.940279 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:42:01.946764 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:01.947759 [debug] [MainThread]: On master: BEGIN
[0m19:42:01.947759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:02.094577 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m19:42:02.094577 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:02.094577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:42:02.110241 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m19:42:02.110241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1D50F4D0>]}
[0m19:42:02.110241 [debug] [MainThread]: On master: ROLLBACK
[0m19:42:02.110241 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:02.110241 [debug] [MainThread]: On master: BEGIN
[0m19:42:02.110241 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:42:02.110241 [debug] [MainThread]: On master: COMMIT
[0m19:42:02.110241 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:02.110241 [debug] [MainThread]: On master: COMMIT
[0m19:42:02.110241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:42:02.110241 [debug] [MainThread]: On master: Close
[0m19:42:02.110241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:42:02.110241 [info ] [MainThread]: 
[0m19:42:02.125865 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:42:02.125865 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:42:02.125865 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:42:02.131971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:42:02.125865 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:42:02.133360 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:42:02.135151 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:42:02.145940 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:42:02.145940 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:42:02.145940 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:42:02.145940 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:42:02.153447 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:42:02.187781 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:42:02.213392 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:42:02.215393 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.216344 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:42:02.216344 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:42:02.217391 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:42:02.219354 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:42:02.220469 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:42:02.253632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m19:42:02.253632 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m19:42:02.253632 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.269261 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:42:02.269261 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:42:02.269261 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:42:02.269261 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:42:02.269261 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:42:02.269261 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:42:02.269261 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:42:02.269261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1D50F650>]}
[0m19:42:02.269261 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.14s]
[0m19:42:02.269261 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:42:02.284884 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:42:02.284884 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:42:02.284884 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:42:02.309412 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.038 seconds
[0m19:42:02.311487 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.311487 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:42:02.311487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:02.322319 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.322762 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:42:02.322762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:42:02.345914 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:42:02.345914 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.345914 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:42:02.365410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m19:42:02.373763 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:42:02.378749 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:42:02.378749 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:42:02.419354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m19:42:02.419354 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:42:02.419354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1BBB5650>]}
[0m19:42:02.419354 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.29s]
[0m19:42:02.419354 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:42:02.419354 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:42:02.435283 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:42:02.435283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:42:02.437756 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:42:02.441273 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:42:02.442905 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:42:02.446276 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:42:02.446276 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:42:02.446276 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:42:02.446276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:42:02.488355 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m19:42:02.488355 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:42:02.488355 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:42:02.488355 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:42:02.503504 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:42:02.504557 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:42:02.505526 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:02.507510 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:42:02.508506 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:42:02.508506 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:42:02.510800 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:42:02.512852 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:42:02.516836 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:42:02.517830 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:42:02.518808 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:42:02.520435 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:42:02.521506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334a27be-7bba-4014-805a-279eb832d1dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1DA7DA90>]}
[0m19:42:02.522503 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:42:02.524458 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:42:02.525454 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:02.526458 [debug] [MainThread]: On master: BEGIN
[0m19:42:02.527446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:02.571154 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m19:42:02.572176 [debug] [MainThread]: On master: COMMIT
[0m19:42:02.573211 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:02.574148 [debug] [MainThread]: On master: COMMIT
[0m19:42:02.575204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:42:02.576138 [debug] [MainThread]: On master: Close
[0m19:42:02.577134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:02.577662 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:42:02.577662 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:42:02.577662 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:42:02.577662 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:42:02.577662 [info ] [MainThread]: 
[0m19:42:02.577662 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m19:42:02.577662 [debug] [MainThread]: Command end result
[0m19:42:02.655237 [info ] [MainThread]: 
[0m19:42:02.655237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:02.655237 [info ] [MainThread]: 
[0m19:42:02.655237 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:42:02.655237 [info ] [MainThread]: 
[0m19:42:02.655237 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:42:02.669912 [debug] [MainThread]: Command `dbt run` failed at 19:42:02.669912 after 2.12 seconds
[0m19:42:02.670951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A151F84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A152D3C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A152D3E50>]}
[0m19:42:02.671863 [debug] [MainThread]: Flushing usage events
[0m19:42:03.955350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:25.231798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962252B0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962255A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962255B650>]}


============================== 19:44:25.231798 | 412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf ==============================
[0m19:44:25.231798 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:44:25.231798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:44:25.419720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622547AD0>]}
[0m19:44:25.482611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961F984410>]}
[0m19:44:25.482611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:44:25.482611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:44:25.654016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:25.654016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:25.707498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196229D6650>]}
[0m19:44:25.827375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962252B7D0>]}
[0m19:44:25.827375 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:44:25.827375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001962294E590>]}
[0m19:44:25.842379 [info ] [MainThread]: 
[0m19:44:25.842379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:25.851390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:44:25.935404 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:44:25.935404 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:44:25.935404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:25.972046 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m19:44:25.972046 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:44:25.987762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:44:25.987762 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:44:25.987762 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:44:25.987762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:26.050470 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m19:44:26.050470 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:44:26.050470 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:44:26.050470 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:44:26.050470 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:44:26.050470 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:44:26.066148 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.066148 [debug] [MainThread]: On master: BEGIN
[0m19:44:26.066148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:26.108426 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m19:44:26.108426 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.108426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:44:26.113929 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m19:44:26.113929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622E7DDD0>]}
[0m19:44:26.113929 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:26.113929 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.113929 [debug] [MainThread]: On master: BEGIN
[0m19:44:26.113929 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:44:26.113929 [debug] [MainThread]: On master: COMMIT
[0m19:44:26.113929 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.113929 [debug] [MainThread]: On master: COMMIT
[0m19:44:26.113929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:44:26.129593 [debug] [MainThread]: On master: Close
[0m19:44:26.129593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:44:26.129593 [info ] [MainThread]: 
[0m19:44:26.129593 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:44:26.129593 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:44:26.129593 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:44:26.141631 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:44:26.129593 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:44:26.142934 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:44:26.143649 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:44:26.153257 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:44:26.153568 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:44:26.158887 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:44:26.160844 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:44:26.175400 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:44:26.203392 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:44:26.220990 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:44:26.222937 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.224037 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:44:26.224037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:44:26.224037 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:44:26.224037 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:44:26.224037 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:44:26.256103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m19:44:26.271106 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:44:26.271106 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:44:26.271106 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:44:26.271106 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:44:26.271106 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:44:26.271106 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:44:26.271106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622FAE250>]}
[0m19:44:26.271106 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.13s]
[0m19:44:26.271106 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:44:26.271106 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:44:26.286735 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:44:26.286735 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:44:26.374656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m19:44:26.375716 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.375716 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:44:26.381324 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:44:26.388361 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.389302 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:44:26.390548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:44:26.393538 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.393538 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:44:26.394537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:44:26.408814 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:44:26.408814 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.408814 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:44:26.408814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:44:26.425029 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:44:26.430012 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:44:26.431013 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:44:26.437796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m19:44:26.439239 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:44:26.439239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019622F7E150>]}
[0m19:44:26.439239 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.31s]
[0m19:44:26.439239 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:44:26.439239 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:44:26.439239 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:44:26.439239 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:44:26.439239 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:44:26.439239 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:44:26.439239 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:44:26.457776 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:44:26.459731 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:44:26.460787 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:44:26.461965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:44:26.505955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m19:44:26.507000 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:44:26.507954 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:44:26.556167 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.058 seconds
[0m19:44:26.571848 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:44:26.571848 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:44:26.571848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:44:26.571848 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:44:26.571848 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:44:26.571848 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:44:26.571848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:44:26.571848 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:44:26.587413 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:44:26.587413 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:44:26.587413 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:44:26.587413 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:44:26.587413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '412ad0e9-d4a3-4c88-be4a-d2213c1e5bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019623035190>]}
[0m19:44:26.587413 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.15s]
[0m19:44:26.587413 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:44:26.587413 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.587413 [debug] [MainThread]: On master: BEGIN
[0m19:44:26.587413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:26.648724 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m19:44:26.649840 [debug] [MainThread]: On master: COMMIT
[0m19:44:26.650548 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:26.651110 [debug] [MainThread]: On master: COMMIT
[0m19:44:26.652176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:44:26.652799 [debug] [MainThread]: On master: Close
[0m19:44:26.653902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:26.654504 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:44:26.655214 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:44:26.655865 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:44:26.657020 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:44:26.658105 [info ] [MainThread]: 
[0m19:44:26.659027 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m19:44:26.661277 [debug] [MainThread]: Command end result
[0m19:44:26.704199 [info ] [MainThread]: 
[0m19:44:26.705912 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:44:26.706661 [info ] [MainThread]: 
[0m19:44:26.709764 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:44:26.711388 [info ] [MainThread]: 
[0m19:44:26.712678 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:44:26.714677 [debug] [MainThread]: Command `dbt run` failed at 19:44:26.713678 after 1.54 seconds
[0m19:44:26.714677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961BEF84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961BFD3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001961BFD3C50>]}
[0m19:44:26.715675 [debug] [MainThread]: Flushing usage events
[0m19:44:28.195877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:42.586445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437652F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437652E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437652ED90>]}


============================== 19:46:42.602070 | a403c49a-28b9-46a6-8418-b2c603c7e0ae ==============================
[0m19:46:42.602070 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:46:42.602070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:42.811832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243768A8CD0>]}
[0m19:46:42.869103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243739843D0>]}
[0m19:46:42.869103 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:46:42.884774 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:46:43.087142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:43.087142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:43.134116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437691FCD0>]}
[0m19:46:43.259495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243768E0410>]}
[0m19:46:43.259495 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:46:43.259495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024376B55B90>]}
[0m19:46:43.269576 [info ] [MainThread]: 
[0m19:46:43.269576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:43.278791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:46:43.344308 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:46:43.344308 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:46:43.344308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:43.393005 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m19:46:43.393005 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:46:43.393005 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:46:43.408696 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m19:46:43.408696 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:46:43.408696 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:46:43.408696 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:43.408696 [debug] [MainThread]: On master: BEGIN
[0m19:46:43.408696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:43.569759 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m19:46:43.569759 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:43.569759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:46:43.581781 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m19:46:43.581781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a403c49a-28b9-46a6-8418-b2c603c7e0ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243769CF4D0>]}
[0m19:46:43.581781 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:43.581781 [debug] [MainThread]: On master: Close
[0m19:46:43.581781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:46:43.581781 [info ] [MainThread]: 
[0m19:46:43.581781 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:46:43.581781 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:46:43.581781 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:46:43.581781 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:46:43.581781 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:46:43.581781 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:46:43.607306 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:46:43.611318 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:46:43.613248 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:46:43.614247 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:46:43.614247 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:46:43.614247 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:46:43.614247 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:43.614247 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:46:43.614247 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m19:46:43.614247 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m19:46:43.614247 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:46:43.614247 [debug] [Thread-2 (]: Began running node model.telegram_data.telegram_summary
[0m19:46:43.614247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m19:46:43.614247 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:46:43.614247 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:43.626149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.telegram_summary)
[0m19:46:43.627606 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m19:46:43.627606 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:46:43.627606 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:46:43.643633 [debug] [Thread-2 (]: Began compiling node model.telegram_data.telegram_summary
[0m19:46:43.650611 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m19:46:43.652080 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:46:43.655142 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.telegram_summary"
[0m19:46:43.657103 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:46:43.658616 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m19:46:43.659618 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_second_dbt_model, now test.telegram_data.not_null_select_all_message_id.63a0c4ebb3)
[0m19:46:43.660612 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m19:46:43.660612 [debug] [Thread-2 (]: Began executing node model.telegram_data.telegram_summary
[0m19:46:43.664639 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m19:46:43.666593 [debug] [Thread-2 (]: Finished running node model.telegram_data.telegram_summary
[0m19:46:43.667588 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m19:46:43.668585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.telegram_summary, now test.telegram_data.unique_select_all_message_id.996fbafff2)
[0m19:46:43.670091 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m19:46:43.670091 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m19:46:43.671133 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m19:46:43.676143 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m19:46:43.676143 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:43.676143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_select_all_message_id.63a0c4ebb3, now test.telegram_data.not_null_my_second_dbt_model_id.151b76d778)
[0m19:46:43.676143 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:43.676143 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m19:46:43.676143 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m19:46:43.676143 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m19:46:43.676143 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:43.676143 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.unique_select_all_message_id.996fbafff2, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:46:43.676143 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:43.676143 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:46:43.707657 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:43.707657 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:43.707657 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m19:46:43.707657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.not_null_telegram_summary_channel_name.9965527363)
[0m19:46:43.707657 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m19:46:43.707657 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m19:46:43.707657 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m19:46:43.723070 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m19:46:43.723070 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m19:46:43.738640 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m19:46:43.754326 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:43.754326 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:43.754326 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:43.754326 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:43.754326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363' was properly closed.
[0m19:46:43.754326 [debug] [MainThread]: Command end result
[0m19:46:43.786052 [debug] [MainThread]: Command `dbt compile` succeeded at 19:46:43.786052 after 1.26 seconds
[0m19:46:43.786052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002437543B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024376899090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002436FF384D0>]}
[0m19:46:43.786052 [debug] [MainThread]: Flushing usage events
[0m19:46:44.342405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:10.937701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC0AC3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC0AC3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC0A6AF90>]}


============================== 19:48:10.953363 | a8ac20cf-9464-4237-9e50-75a13390e47b ==============================
[0m19:48:10.953363 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:48:10.953363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:48:11.139947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC0AEB290>]}
[0m19:48:11.187880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEBF851510>]}
[0m19:48:11.187880 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:48:11.204087 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:48:11.378481 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:48:11.378481 [debug] [MainThread]: Partial parsing: added file: telegram_data://models\sources\sources.yml
[0m19:48:11.660515 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:48:11.660515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC0AC3D50>]}
[0m19:48:11.838988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC1117590>]}
[0m19:48:12.004746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC23EE450>]}
[0m19:48:12.004746 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:48:12.004746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC23ADA90>]}
[0m19:48:12.004746 [info ] [MainThread]: 
[0m19:48:12.004746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:48:12.023449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:48:12.101832 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:48:12.102807 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:48:12.102807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:12.190455 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.097 seconds
[0m19:48:12.190455 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:48:12.206841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:48:12.206841 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:48:12.206841 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:48:12.206841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:12.363496 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m19:48:12.363496 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:48:12.363496 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:48:12.363496 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:48:12.363496 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:48:12.363496 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:48:12.380143 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:12.380143 [debug] [MainThread]: On master: BEGIN
[0m19:48:12.380143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:12.427980 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m19:48:12.427980 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:12.427980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:12.443596 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m19:48:12.445592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC10B33D0>]}
[0m19:48:12.446610 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:12.447472 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:12.447472 [debug] [MainThread]: On master: BEGIN
[0m19:48:12.448869 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:48:12.448869 [debug] [MainThread]: On master: COMMIT
[0m19:48:12.449926 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:12.449926 [debug] [MainThread]: On master: COMMIT
[0m19:48:12.451213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:12.451213 [debug] [MainThread]: On master: Close
[0m19:48:12.452212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:12.453212 [info ] [MainThread]: 
[0m19:48:12.458198 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:48:12.459189 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:48:12.460513 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:48:12.461513 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:48:12.462509 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:48:12.463506 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:48:12.464317 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:48:12.464317 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:48:12.466407 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:48:12.466407 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:48:12.477764 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:48:12.493085 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:48:12.532401 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:48:12.553648 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:48:12.555594 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:48:12.556592 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.556592 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:48:12.557661 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:48:12.558586 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:48:12.559579 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:12.593594 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m19:48:12.593594 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:48:12.593594 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:48:12.593594 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:48:12.593594 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:48:12.593594 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:48:12.608597 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:48:12.608597 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC27BB910>]}
[0m19:48:12.608597 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.15s]
[0m19:48:12.608597 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:48:12.608597 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:48:12.608597 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:48:12.608597 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:48:12.711112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m19:48:12.712247 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.712767 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:48:12.719408 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m19:48:12.728021 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.729174 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:48:12.730902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:12.734195 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.734195 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:48:12.735701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:12.765635 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:48:12.767111 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.768193 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:48:12.770494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:48:12.779951 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:48:12.786091 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:48:12.787203 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:48:12.805901 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m19:48:12.805901 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:48:12.805901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC23C20D0>]}
[0m19:48:12.818126 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.34s]
[0m19:48:12.818126 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:48:12.820630 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:48:12.821348 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:48:12.821348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:48:12.821348 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:48:12.821348 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:48:12.821348 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:48:12.821348 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:48:12.821348 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:48:12.821348 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:48:12.821348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:48:12.980852 [debug] [Thread-2 (]: SQL status: BEGIN in 0.147 seconds
[0m19:48:12.981872 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:48:12.982850 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:48:12.988000 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:48:12.991495 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:48:12.992496 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:48:12.993449 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:48:12.995550 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:48:12.995550 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:48:12.995550 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:48:12.995550 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:48:12.995550 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:48:12.995550 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:48:12.995550 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:48:12.995550 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:48:12.995550 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:48:12.995550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ac20cf-9464-4237-9e50-75a13390e47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEC2CFED50>]}
[0m19:48:13.011261 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.17s]
[0m19:48:13.011261 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:48:13.011261 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:13.011261 [debug] [MainThread]: On master: BEGIN
[0m19:48:13.011261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:13.062969 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m19:48:13.062969 [debug] [MainThread]: On master: COMMIT
[0m19:48:13.062969 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:13.062969 [debug] [MainThread]: On master: COMMIT
[0m19:48:13.062969 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:48:13.062969 [debug] [MainThread]: On master: Close
[0m19:48:13.062969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:13.062969 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:48:13.062969 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:48:13.062969 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:48:13.062969 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:48:13.062969 [info ] [MainThread]: 
[0m19:48:13.062969 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m19:48:13.077387 [debug] [MainThread]: Command end result
[0m19:48:13.145799 [info ] [MainThread]: 
[0m19:48:13.159862 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:48:13.160877 [info ] [MainThread]: 
[0m19:48:13.162519 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:48:13.164534 [info ] [MainThread]: 
[0m19:48:13.166511 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:48:13.169448 [debug] [MainThread]: Command `dbt run` failed at 19:48:13.168435 after 2.29 seconds
[0m19:48:13.169448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEBA4B84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEBA593C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEBA593B90>]}
[0m19:48:13.170447 [debug] [MainThread]: Flushing usage events
[0m19:48:21.168123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:35.432039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782DE9F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782DEF22D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782DEF0AD0>]}


============================== 19:49:35.438018 | 8114d11f-fa73-4412-aded-e00367208db6 ==============================
[0m19:49:35.438018 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:35.439949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:35.610651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8114d11f-fa73-4412-aded-e00367208db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782DF178D0>]}
[0m19:49:35.657600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8114d11f-fa73-4412-aded-e00367208db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782B2F4B90>]}
[0m19:49:35.673155 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:49:35.673155 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:49:35.840058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:35.840058 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\telegram_summary.sql
[0m19:49:36.040051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:49:36.040051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8114d11f-fa73-4412-aded-e00367208db6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782E1C3790>]}
[0m19:49:36.150488 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_data.telegram_summary' (models\telegram_summary.sql) depends on a node named 'transformed_telegram_data' which was not found
[0m19:49:36.152441 [debug] [MainThread]: Command `dbt run` failed at 19:49:36.152441 after 0.79 seconds
[0m19:49:36.153475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278279084D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002782DE9DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278279E3B50>]}
[0m19:49:36.153475 [debug] [MainThread]: Flushing usage events
[0m19:49:37.640969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:16.211641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E712B210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E715B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E715B150>]}


============================== 19:50:16.227291 | 7ac2ca43-b7e4-4840-82a1-a80269193f3a ==============================
[0m19:50:16.227291 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:16.227291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:50:16.454080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7147D90>]}
[0m19:50:16.507313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E4583E50>]}
[0m19:50:16.507313 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:50:16.507313 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:16.675775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:16.675775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:16.707035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7632B50>]}
[0m19:50:16.848179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7462910>]}
[0m19:50:16.848179 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:50:16.848179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E74DE9D0>]}
[0m19:50:16.848179 [info ] [MainThread]: 
[0m19:50:16.848179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:50:16.848179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:50:16.940395 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:50:16.941395 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:50:16.941395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:16.992463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m19:50:16.994460 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:50:16.995420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:50:16.995420 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:50:16.995420 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:50:16.995420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:17.153051 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m19:50:17.153051 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:50:17.153051 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:50:17.153051 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:50:17.169445 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:50:17.169445 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:50:17.169445 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.169445 [debug] [MainThread]: On master: BEGIN
[0m19:50:17.177032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:17.215806 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m19:50:17.215806 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.215806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:50:17.215806 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m19:50:17.231473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7553390>]}
[0m19:50:17.231473 [debug] [MainThread]: On master: ROLLBACK
[0m19:50:17.231473 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.231473 [debug] [MainThread]: On master: BEGIN
[0m19:50:17.231473 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:50:17.231473 [debug] [MainThread]: On master: COMMIT
[0m19:50:17.231473 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.231473 [debug] [MainThread]: On master: COMMIT
[0m19:50:17.231473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:17.231473 [debug] [MainThread]: On master: Close
[0m19:50:17.231473 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:17.231473 [info ] [MainThread]: 
[0m19:50:17.231473 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:50:17.231473 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:50:17.231473 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:50:17.248243 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:50:17.247055 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:50:17.249265 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:50:17.249838 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:50:17.260229 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:50:17.260229 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:50:17.265990 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:50:17.266930 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:50:17.298064 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:50:17.312147 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:50:17.332079 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:50:17.333078 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.334024 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:50:17.335021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:17.335021 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:50:17.337018 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:50:17.337018 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:50:17.378386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m19:50:17.378386 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:50:17.378386 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:50:17.378386 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:50:17.378386 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:50:17.378386 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:50:17.378386 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:50:17.378386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7B98250>]}
[0m19:50:17.378386 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.13s]
[0m19:50:17.378386 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:50:17.394050 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:50:17.394050 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:50:17.394050 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:50:17.480450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m19:50:17.481523 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.481523 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:50:17.487111 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:50:17.494146 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.494470 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:50:17.496026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:17.496026 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.496026 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:50:17.496026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:17.525924 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:50:17.526920 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.528507 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:50:17.528507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:17.528507 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:50:17.528507 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:50:17.528507 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:50:17.544095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m19:50:17.559772 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:50:17.561890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7550450>]}
[0m19:50:17.561890 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.31s]
[0m19:50:17.561890 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:50:17.561890 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:50:17.561890 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:50:17.561890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:50:17.570161 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:50:17.575118 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:50:17.575118 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:50:17.583473 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:50:17.584417 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:50:17.584417 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:50:17.585414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:50:17.631668 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m19:50:17.632748 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:50:17.633750 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:50:17.638778 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:50:17.641770 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:50:17.641770 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:50:17.643575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:50:17.644574 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:50:17.645986 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:50:17.646986 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:50:17.648450 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:50:17.650496 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:50:17.653480 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:50:17.654500 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:50:17.655433 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:50:17.656494 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:50:17.657460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac2ca43-b7e4-4840-82a1-a80269193f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7C2D7D0>]}
[0m19:50:17.658421 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.10s]
[0m19:50:17.660422 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:50:17.662417 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.662417 [debug] [MainThread]: On master: BEGIN
[0m19:50:17.662417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:17.712972 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m19:50:17.713901 [debug] [MainThread]: On master: COMMIT
[0m19:50:17.715134 [debug] [MainThread]: Using postgres connection "master"
[0m19:50:17.715134 [debug] [MainThread]: On master: COMMIT
[0m19:50:17.715134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:50:17.715134 [debug] [MainThread]: On master: Close
[0m19:50:17.715134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:17.715134 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:50:17.715134 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:50:17.715134 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:50:17.715134 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:50:17.715134 [info ] [MainThread]: 
[0m19:50:17.715134 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m19:50:17.715134 [debug] [MainThread]: Command end result
[0m19:50:17.753209 [info ] [MainThread]: 
[0m19:50:17.753209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:50:17.753209 [info ] [MainThread]: 
[0m19:50:17.762793 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:50:17.765462 [info ] [MainThread]: 
[0m19:50:17.767049 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:50:17.769043 [debug] [MainThread]: Command `dbt run` failed at 19:50:17.769043 after 1.80 seconds
[0m19:50:17.770039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E0B284D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E7194E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210E0C03B10>]}
[0m19:50:17.770039 [debug] [MainThread]: Flushing usage events
[0m19:50:20.434796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:31.361535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACFFEEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD001F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0041FD0>]}


============================== 19:55:31.361535 | 20f27db6-1a47-435c-969d-a8696075687e ==============================
[0m19:55:31.361535 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:31.361535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:31.563866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0369B10>]}
[0m19:55:31.611893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD444AD0>]}
[0m19:55:31.611893 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:55:31.626437 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:31.800664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:31.800664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:31.847573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0532710>]}
[0m19:55:31.988608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD02D38D0>]}
[0m19:55:31.988608 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:55:31.988608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD061AC10>]}
[0m19:55:31.988608 [info ] [MainThread]: 
[0m19:55:31.988608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:32.004868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:55:32.083036 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:55:32.083036 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:55:32.084034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:32.133179 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m19:55:32.133179 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:55:32.133179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:55:32.139664 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:55:32.139664 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:55:32.139664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:32.289293 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m19:55:32.289293 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:55:32.289293 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:55:32.289293 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:55:32.289293 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:55:32.289293 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:55:32.306220 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:32.306220 [debug] [MainThread]: On master: BEGIN
[0m19:55:32.306220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:32.459488 [debug] [MainThread]: SQL status: BEGIN in 0.154 seconds
[0m19:55:32.490745 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:32.490745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:55:32.506320 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m19:55:32.506320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0040F10>]}
[0m19:55:32.506320 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:32.513327 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:32.513327 [debug] [MainThread]: On master: BEGIN
[0m19:55:32.513327 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:55:32.513327 [debug] [MainThread]: On master: COMMIT
[0m19:55:32.513327 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:32.513327 [debug] [MainThread]: On master: COMMIT
[0m19:55:32.513327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:55:32.513327 [debug] [MainThread]: On master: Close
[0m19:55:32.513327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:32.513327 [info ] [MainThread]: 
[0m19:55:32.521987 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:55:32.521987 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m19:55:32.521987 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:55:32.528825 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:55:32.530162 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:55:32.531199 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m19:55:32.532196 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:55:32.533119 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m19:55:32.542160 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:55:32.543156 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:55:32.543156 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:55:32.556381 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m19:55:32.594612 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:55:32.613325 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:55:32.614601 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.616582 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:55:32.617452 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:55:32.618494 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m19:55:32.619498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:32.620494 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:55:32.667809 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m19:55:32.667809 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:55:32.667809 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:55:32.667809 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:55:32.667809 [debug] [Thread-2 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:55:32.667809 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m19:55:32.677441 [debug] [Thread-2 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:55:32.677441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0A4F8D0>]}
[0m19:55:32.682943 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.15s]
[0m19:55:32.682943 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m19:55:32.682943 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m19:55:32.682943 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:55:32.688955 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m19:55:32.774707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m19:55:32.775225 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.776434 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:55:32.781462 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:55:32.789942 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.790491 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:55:32.791719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:55:32.794908 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.795905 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:55:32.796997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:55:32.818427 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:55:32.818427 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.818427 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:55:32.835385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m19:55:32.835385 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:55:32.854052 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:32.854990 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:55:32.864872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m19:55:32.867365 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:55:32.867365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0A6BC10>]}
[0m19:55:32.867365 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.34s]
[0m19:55:32.867365 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:55:32.867365 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:55:32.867365 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:55:32.867365 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:55:32.867365 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:55:32.867365 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:55:32.867365 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:55:32.886337 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:55:32.888130 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:32.889334 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:55:32.889334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:32.936361 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m19:55:32.936361 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:32.936361 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:55:32.936361 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m19:55:32.936361 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:32.950765 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:55:32.952070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:55:32.955064 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:55:32.956125 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:32.957057 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:55:32.999851 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m19:55:33.014419 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:55:33.015925 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:33.015925 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:55:33.015925 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:55:33.015925 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:55:33.015925 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20f27db6-1a47-435c-969d-a8696075687e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0A445D0>]}
[0m19:55:33.015925 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.15s]
[0m19:55:33.015925 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:55:33.027266 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:33.027266 [debug] [MainThread]: On master: BEGIN
[0m19:55:33.027266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:33.214371 [debug] [MainThread]: SQL status: BEGIN in 0.186 seconds
[0m19:55:33.214371 [debug] [MainThread]: On master: COMMIT
[0m19:55:33.214371 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:33.214371 [debug] [MainThread]: On master: COMMIT
[0m19:55:33.214371 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:55:33.214371 [debug] [MainThread]: On master: Close
[0m19:55:33.214371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:33.214371 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:55:33.214371 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:55:33.214371 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m19:55:33.214371 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:55:33.214371 [info ] [MainThread]: 
[0m19:55:33.214371 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m19:55:33.214371 [debug] [MainThread]: Command end result
[0m19:55:33.258657 [info ] [MainThread]: 
[0m19:55:33.258657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:55:33.258657 [info ] [MainThread]: 
[0m19:55:33.258657 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:55:33.267160 [info ] [MainThread]: 
[0m19:55:33.269083 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:55:33.272008 [debug] [MainThread]: Command `dbt run` failed at 19:55:33.272008 after 1.98 seconds
[0m19:55:33.272008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACFDC2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0369090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC9AF3B10>]}
[0m19:55:33.273004 [debug] [MainThread]: Flushing usage events
[0m19:55:35.638334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:55:50.824779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8385CE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8385CEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D838620AD0>]}


============================== 19:55:50.824779 | c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2 ==============================
[0m19:55:50.824779 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:50.824779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\USER\\.dbt', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:51.013667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D838906E10>]}
[0m19:55:51.060919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D835A24C50>]}
[0m19:55:51.060919 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:55:51.076561 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:51.232676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:51.232676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:51.280142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D838B23E90>]}
[0m19:55:51.405573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D838623D50>]}
[0m19:55:51.405573 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m19:55:51.405573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8389EFFD0>]}
[0m19:55:51.421237 [info ] [MainThread]: 
[0m19:55:51.421237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:51.421237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m19:55:51.506134 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m19:55:51.507131 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m19:55:51.507131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:51.662167 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.162 seconds
[0m19:55:51.662167 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m19:55:51.662167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m19:55:51.677857 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:55:51.677857 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m19:55:51.677857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:51.709043 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m19:55:51.709043 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m19:55:51.709043 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:55:51.724666 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m19:55:51.724666 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m19:55:51.724666 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m19:55:51.724666 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:51.724666 [debug] [MainThread]: On master: BEGIN
[0m19:55:51.724666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:51.771960 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m19:55:51.771960 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:51.771960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:55:51.787582 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m19:55:51.787582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8389D71D0>]}
[0m19:55:51.787582 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:51.787582 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:51.787582 [debug] [MainThread]: On master: BEGIN
[0m19:55:51.787582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:55:51.787582 [debug] [MainThread]: On master: COMMIT
[0m19:55:51.787582 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:51.787582 [debug] [MainThread]: On master: COMMIT
[0m19:55:51.787582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:55:51.787582 [debug] [MainThread]: On master: Close
[0m19:55:51.787582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:51.787582 [info ] [MainThread]: 
[0m19:55:51.803207 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m19:55:51.803207 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:55:51.803207 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m19:55:51.808853 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m19:55:51.820927 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m19:55:51.820927 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m19:55:51.853888 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m19:55:51.853888 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:51.867612 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m19:55:51.868615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:52.016427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m19:55:52.016427 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:52.016427 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:55:52.016427 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m19:55:52.016427 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:52.031441 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:55:52.031441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:55:52.031441 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:52.031441 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:55:52.031441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:55:52.048614 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:55:52.048614 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:52.048614 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m19:55:52.078888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m19:55:52.078888 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m19:55:52.094475 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m19:55:52.094475 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:55:52.110246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m19:55:52.110246 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m19:55:52.110246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D838FA28D0>]}
[0m19:55:52.110246 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.31s]
[0m19:55:52.110246 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m19:55:52.110246 [debug] [Thread-1 (]: Began running node model.telegram_data.select_all
[0m19:55:52.110246 [info ] [Thread-1 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m19:55:52.110246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now model.telegram_data.select_all)
[0m19:55:52.110246 [debug] [Thread-1 (]: Began compiling node model.telegram_data.select_all
[0m19:55:52.127909 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m19:55:52.130366 [debug] [Thread-1 (]: Began executing node model.telegram_data.select_all
[0m19:55:52.153360 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m19:55:52.153360 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:55:52.153360 [debug] [Thread-1 (]: On model.telegram_data.select_all: BEGIN
[0m19:55:52.153360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:52.202556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m19:55:52.202694 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.select_all"
[0m19:55:52.202694 [debug] [Thread-1 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m19:55:52.202694 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.transformed_telegram_data" does not exist
LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                  ^

[0m19:55:52.202694 [debug] [Thread-1 (]: On model.telegram_data.select_all: ROLLBACK
[0m19:55:52.202694 [debug] [Thread-1 (]: On model.telegram_data.select_all: Close
[0m19:55:52.202694 [debug] [Thread-1 (]: Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:55:52.202694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D839114AD0>]}
[0m19:55:52.202694 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model public.select_all ......................... [[31mERROR[0m in 0.09s]
[0m19:55:52.202694 [debug] [Thread-1 (]: Finished running node model.telegram_data.select_all
[0m19:55:52.202694 [debug] [Thread-1 (]: Began running node model.telegram_data.my_second_dbt_model
[0m19:55:52.202694 [info ] [Thread-1 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:55:52.218357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m19:55:52.218357 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m19:55:52.218357 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m19:55:52.218357 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m19:55:52.218357 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m19:55:52.218357 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:52.218357 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m19:55:52.218357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:52.269644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m19:55:52.269644 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:52.269644 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:55:52.269644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m19:55:52.288458 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:52.289450 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:55:52.290465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:55:52.292382 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:55:52.293374 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:52.293374 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m19:55:52.295827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:55:52.298898 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m19:55:52.301446 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m19:55:52.302483 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:55:52.303439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:55:52.304478 [debug] [Thread-1 (]: On model.telegram_data.my_second_dbt_model: Close
[0m19:55:52.305483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c29ad5e2-3bff-4d6b-a9b2-145f7e51c6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8385E8810>]}
[0m19:55:52.306429 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:55:52.308423 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m19:55:52.309421 [debug] [Thread-1 (]: Began running node model.telegram_data.telegram_summary
[0m19:55:52.310417 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.telegram_summary ................................... [[33mSKIP[0m]
[0m19:55:52.311216 [debug] [Thread-1 (]: Finished running node model.telegram_data.telegram_summary
[0m19:55:52.313221 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:52.314250 [debug] [MainThread]: On master: BEGIN
[0m19:55:52.314250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:52.464256 [debug] [MainThread]: SQL status: BEGIN in 0.150 seconds
[0m19:55:52.466029 [debug] [MainThread]: On master: COMMIT
[0m19:55:52.466589 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:52.467177 [debug] [MainThread]: On master: COMMIT
[0m19:55:52.468277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:55:52.468917 [debug] [MainThread]: On master: Close
[0m19:55:52.469988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:52.470572 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m19:55:52.471142 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m19:55:52.471644 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m19:55:52.472687 [info ] [MainThread]: 
[0m19:55:52.473729 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m19:55:52.476091 [debug] [MainThread]: Command end result
[0m19:55:52.515717 [info ] [MainThread]: 
[0m19:55:52.517663 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:55:52.518666 [info ] [MainThread]: 
[0m19:55:52.520892 [error] [MainThread]:   Database Error in model select_all (models\select_all.sql)
  relation "public.transformed_telegram_data" does not exist
  LINE 16:     FROM "Telegram_data"."public"."transformed_telegram_data...
                    ^
  compiled code at target\run\telegram_data\models\select_all.sql
[0m19:55:52.520892 [info ] [MainThread]: 
[0m19:55:52.553800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m19:55:52.567576 [debug] [MainThread]: Command `dbt run` failed at 19:55:52.553800 after 1.80 seconds
[0m19:55:52.568579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8320A3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8320A2F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8389C9F10>]}
[0m19:55:52.568579 [debug] [MainThread]: Flushing usage events
[0m19:55:53.459455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:31.205641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA74EFAE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA74F51810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA74F508D0>]}


============================== 20:23:31.284027 | a8bbabfe-8624-4663-a1b5-51d25173c763 ==============================
[0m20:23:31.284027 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:23:31.284027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:23:33.453479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7523D190>]}
[0m20:23:33.516551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA723543D0>]}
[0m20:23:33.530074 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:23:33.553821 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:23:33.869750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:33.869750 [debug] [MainThread]: Partial parsing: updated file: telegram_data://tests\my_test.sql
[0m20:23:34.058484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA753B2D50>]}
[0m20:23:34.890688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7665FE90>]}
[0m20:23:34.906324 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 423 macros
[0m20:23:34.908333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA753BC2D0>]}
[0m20:23:34.908333 [info ] [MainThread]: 
[0m20:23:34.908333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:23:34.935780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m20:23:35.279729 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m20:23:35.279729 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m20:23:35.279729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:35.361975 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.074 seconds
[0m20:23:35.377827 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m20:23:35.377827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m20:23:35.393274 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:23:35.393274 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m20:23:35.393274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:35.440565 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m20:23:35.440565 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:23:35.440565 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:23:35.519161 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.085 seconds
[0m20:23:35.534798 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m20:23:35.534798 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m20:23:35.534798 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:35.534798 [debug] [MainThread]: On master: BEGIN
[0m20:23:35.534798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:35.582446 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m20:23:35.582446 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:35.582446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:23:35.629892 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m20:23:35.629892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA766774D0>]}
[0m20:23:35.629892 [debug] [MainThread]: On master: ROLLBACK
[0m20:23:35.629892 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:35.645261 [debug] [MainThread]: On master: BEGIN
[0m20:23:35.646580 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:23:35.646580 [debug] [MainThread]: On master: COMMIT
[0m20:23:35.646580 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:35.646580 [debug] [MainThread]: On master: COMMIT
[0m20:23:35.646580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:23:35.646580 [debug] [MainThread]: On master: Close
[0m20:23:35.646580 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:35.646580 [info ] [MainThread]: 
[0m20:23:35.716530 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m20:23:35.717579 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m20:23:35.718530 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:23:35.720522 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m20:23:35.721950 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m20:23:35.722424 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m20:23:35.723449 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m20:23:35.724172 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m20:23:35.734581 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m20:23:35.738564 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m20:23:35.749778 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m20:23:35.803016 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m20:23:35.804013 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m20:23:35.826565 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m20:23:35.894873 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:23:35.894873 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m20:23:35.894873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:23:35.913893 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:35.914941 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m20:23:35.916060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:23:35.946399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m20:23:35.946927 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:23:35.947981 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m20:23:35.959657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m20:23:35.959657 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:35.959657 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:23:36.018022 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.061 seconds
[0m20:23:36.033651 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:36.033651 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:23:36.080608 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.142 seconds
[0m20:23:36.080608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.054 seconds
[0m20:23:36.097152 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:23:36.097152 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:36.097152 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all__dbt_tmp" rename to "select_all"
[0m20:23:36.097152 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:23:36.097152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:23:36.097152 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:23:36.127786 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m20:23:36.127786 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m20:23:36.127786 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:36.127786 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:23:36.127786 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m20:23:36.127786 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m20:23:36.127786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:23:36.127786 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m20:23:36.127786 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m20:23:36.143410 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:23:36.143410 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."select_all__dbt_backup"
[0m20:23:36.143410 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:23:36.143410 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:23:36.143410 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
drop view if exists "Telegram_data"."public"."select_all__dbt_backup" cascade
[0m20:23:36.253944 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.106 seconds
[0m20:23:36.253944 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m20:23:36.269298 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA7694CA10>]}
[0m20:23:36.269298 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.select_all ............................. [[32mCREATE VIEW[0m in 0.53s]
[0m20:23:36.269298 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.129 seconds
[0m20:23:36.269298 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m20:23:36.287550 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m20:23:36.289427 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m20:23:36.291088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA755BE8D0>]}
[0m20:23:36.292085 [info ] [Thread-4 (]: 3 of 4 START sql view model public.telegram_summary ............................ [RUN]
[0m20:23:36.293896 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.57s]
[0m20:23:36.295236 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.telegram_summary'
[0m20:23:36.297188 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m20:23:36.298186 [debug] [Thread-4 (]: Began compiling node model.telegram_data.telegram_summary
[0m20:23:36.304700 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.telegram_summary"
[0m20:23:36.305686 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m20:23:36.306194 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:23:36.308129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m20:23:36.308549 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m20:23:36.311253 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m20:23:36.313693 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m20:23:36.319151 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m20:23:36.333316 [debug] [Thread-4 (]: Began executing node model.telegram_data.telegram_summary
[0m20:23:36.333316 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.telegram_summary"
[0m20:23:36.333316 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:23:36.333316 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: BEGIN
[0m20:23:36.333316 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:23:36.347934 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:23:36.347934 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m20:23:36.347934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:23:36.489653 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m20:23:36.489653 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:23:36.489653 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.telegram_summary"} */

  create view "Telegram_data"."public"."telegram_summary__dbt_tmp"
    
    
  as (
    -- models/telegram_summary.sql

with transformed_data as (
    select * from "Telegram_data"."public"."select_all" 
)

select
    channel_name,
    count(message_id) as total_messages,
    max(timestamp) as latest_message
from transformed_data
group by channel_name;
  );
[0m20:23:36.505332 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m20:23:36.505332 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:23:36.505332 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:23:36.511850 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:23:36.521399 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:23:36.521399 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:23:36.521399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:23:36.521399 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m20:23:36.521399 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:23:36.521399 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m20:23:36.521399 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:23:36.521399 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m20:23:36.521399 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:23:36.521399 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:23:36.521399 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:23:36.537065 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m20:23:36.537065 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA76AD3FD0>]}
[0m20:23:36.537065 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.23s]
[0m20:23:36.537065 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m20:23:36.551903 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: group by channel_name;
                              ^

[0m20:23:36.552899 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: ROLLBACK
[0m20:23:36.553896 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: Close
[0m20:23:36.787549 [debug] [Thread-4 (]: Database Error in model telegram_summary (models\telegram_summary.sql)
  syntax error at or near ";"
  LINE 18: group by channel_name;
                                ^
  compiled code at target\run\telegram_data\models\telegram_summary.sql
[0m20:23:36.787549 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8bbabfe-8624-4663-a1b5-51d25173c763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA753BD310>]}
[0m20:23:36.787549 [error] [Thread-4 (]: 3 of 4 ERROR creating sql view model public.telegram_summary ................... [[31mERROR[0m in 0.49s]
[0m20:23:36.787549 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m20:23:36.787549 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:36.787549 [debug] [MainThread]: On master: BEGIN
[0m20:23:36.787549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:36.847793 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m20:23:36.847793 [debug] [MainThread]: On master: COMMIT
[0m20:23:36.847793 [debug] [MainThread]: Using postgres connection "master"
[0m20:23:36.847793 [debug] [MainThread]: On master: COMMIT
[0m20:23:36.847793 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:23:36.847793 [debug] [MainThread]: On master: Close
[0m20:23:36.847793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:36.847793 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m20:23:36.847793 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m20:23:36.847793 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m20:23:36.847793 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m20:23:36.847793 [debug] [MainThread]: Connection 'model.telegram_data.telegram_summary' was properly closed.
[0m20:23:36.847793 [info ] [MainThread]: 
[0m20:23:36.847793 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m20:23:36.847793 [debug] [MainThread]: Command end result
[0m20:23:36.899931 [info ] [MainThread]: 
[0m20:23:36.912813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:23:36.914897 [info ] [MainThread]: 
[0m20:23:36.914897 [error] [MainThread]:   Database Error in model telegram_summary (models\telegram_summary.sql)
  syntax error at or near ";"
  LINE 18: group by channel_name;
                                ^
  compiled code at target\run\telegram_data\models\telegram_summary.sql
[0m20:23:36.965486 [info ] [MainThread]: 
[0m20:23:36.965486 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:23:36.981232 [debug] [MainThread]: Command `dbt run` failed at 20:23:36.980250 after 6.09 seconds
[0m20:23:36.982165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6E9984D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6EA73C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA6EA73B10>]}
[0m20:23:36.983207 [debug] [MainThread]: Flushing usage events
[0m20:23:37.978850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:51.554178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78834F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7883A3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7883A1010>]}


============================== 20:24:51.554178 | 8fd57af8-ea6f-47be-97f9-2fa8460d267e ==============================
[0m20:24:51.554178 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:24:51.554178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:24:51.741674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E788673590>]}
[0m20:24:51.789167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7857A4950>]}
[0m20:24:51.789167 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:24:51.789167 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:24:52.132415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:24:52.144921 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\telegram_summary.sql
[0m20:24:52.370135 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:24:52.370135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E788A6F510>]}
[0m20:24:52.563007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7887009D0>]}
[0m20:24:52.697176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E789C45510>]}
[0m20:24:52.697176 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 423 macros
[0m20:24:52.697176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E789B69490>]}
[0m20:24:52.697176 [info ] [MainThread]: 
[0m20:24:52.697176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:52.697176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data'
[0m20:24:52.790046 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data"
[0m20:24:52.790046 [debug] [ThreadPool]: On list_Telegram_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data"} */

    select distinct nspname from pg_namespace
  
[0m20:24:52.791035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:52.945703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.163 seconds
[0m20:24:52.945703 [debug] [ThreadPool]: On list_Telegram_data: Close
[0m20:24:52.956264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m20:24:52.956264 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:24:52.956264 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m20:24:52.956264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:53.003138 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m20:24:53.003138 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:24:53.003138 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:24:53.003138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:24:53.003138 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m20:24:53.003138 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m20:24:53.018803 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.018803 [debug] [MainThread]: On master: BEGIN
[0m20:24:53.018803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:53.065961 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m20:24:53.065961 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.065961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:53.081586 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m20:24:53.081586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E789C06350>]}
[0m20:24:53.081586 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:53.081586 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.081586 [debug] [MainThread]: On master: BEGIN
[0m20:24:53.081586 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:24:53.081586 [debug] [MainThread]: On master: COMMIT
[0m20:24:53.081586 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.081586 [debug] [MainThread]: On master: COMMIT
[0m20:24:53.081586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:53.081586 [debug] [MainThread]: On master: Close
[0m20:24:53.081586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:24:53.081586 [info ] [MainThread]: 
[0m20:24:53.081586 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m20:24:53.081586 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m20:24:53.097209 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:24:53.098403 [info ] [Thread-2 (]: 2 of 4 START sql view model public.select_all .................................. [RUN]
[0m20:24:53.100109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m20:24:53.101125 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m20:24:53.102121 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m20:24:53.102675 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m20:24:53.110585 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m20:24:53.115879 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m20:24:53.117804 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m20:24:53.118802 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m20:24:53.195010 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.select_all"
[0m20:24:53.198946 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_data.my_first_dbt_model"
[0m20:24:53.200017 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.200540 [debug] [Thread-2 (]: On model.telegram_data.select_all: BEGIN
[0m20:24:53.201580 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.202095 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:24:53.203201 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: BEGIN
[0m20:24:53.204267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:24:53.247718 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m20:24:53.247718 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.247718 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */

  create view "Telegram_data"."public"."select_all__dbt_tmp"
    
    
  as (
    WITH source_data AS (
    SELECT 
        channel_name,
        channel_handle,
        message_id,
        message_text,
        timestamp,
        media_path,
        header_text
    FROM "Telegram_data"."public"."transformed_telegram_data"
)

SELECT 
    channel_name,
    channel_handle,
    message_id,
    message_text,
    timestamp,
    media_path,
    header_text
FROM source_data
  );
[0m20:24:53.257864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m20:24:53.257864 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:24:53.257864 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.270997 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.272020 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */

  
    

  create  table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:24:53.272608 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all" rename to "select_all__dbt_backup"
[0m20:24:53.274197 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:24:53.278925 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.279562 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m20:24:53.280113 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
alter table "Telegram_data"."public"."select_all__dbt_tmp" rename to "select_all"
[0m20:24:53.284101 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.285213 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:24:53.286233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:24:53.293711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:24:53.311036 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m20:24:53.315145 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.316169 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.316685 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
alter table "Telegram_data"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:24:53.317759 [debug] [Thread-2 (]: On model.telegram_data.select_all: COMMIT
[0m20:24:53.318946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:24:53.320158 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:24:53.326580 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m20:24:53.334526 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."select_all__dbt_backup"
[0m20:24:53.335560 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.341591 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.select_all"
[0m20:24:53.342130 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: COMMIT
[0m20:24:53.342130 [debug] [Thread-2 (]: On model.telegram_data.select_all: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.select_all"} */
drop view if exists "Telegram_data"."public"."select_all__dbt_backup" cascade
[0m20:24:53.342130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:24:53.342130 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:24:53.346154 [debug] [Thread-1 (]: Applying DROP to: "Telegram_data"."public"."my_first_dbt_model__dbt_backup"
[0m20:24:53.346154 [debug] [Thread-2 (]: On model.telegram_data.select_all: Close
[0m20:24:53.346154 [debug] [Thread-1 (]: Using postgres connection "model.telegram_data.my_first_dbt_model"
[0m20:24:53.356323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E788AAFB50>]}
[0m20:24:53.356323 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_first_dbt_model"} */
drop table if exists "Telegram_data"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:24:53.356323 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.select_all ............................. [[32mCREATE VIEW[0m in 0.25s]
[0m20:24:53.356323 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m20:24:53.356323 [debug] [Thread-4 (]: Began running node model.telegram_data.telegram_summary
[0m20:24:53.356323 [info ] [Thread-4 (]: 3 of 4 START sql view model public.telegram_summary ............................ [RUN]
[0m20:24:53.356323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.telegram_summary'
[0m20:24:53.356323 [debug] [Thread-4 (]: Began compiling node model.telegram_data.telegram_summary
[0m20:24:53.356323 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.telegram_summary"
[0m20:24:53.356323 [debug] [Thread-4 (]: Began executing node model.telegram_data.telegram_summary
[0m20:24:53.373620 [debug] [Thread-4 (]: Writing runtime sql for node "model.telegram_data.telegram_summary"
[0m20:24:53.375355 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:24:53.375355 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: BEGIN
[0m20:24:53.376352 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:24:53.377353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m20:24:53.382424 [debug] [Thread-1 (]: On model.telegram_data.my_first_dbt_model: Close
[0m20:24:53.383421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E789C046D0>]}
[0m20:24:53.385421 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.28s]
[0m20:24:53.387483 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m20:24:53.388608 [debug] [Thread-2 (]: Began running node model.telegram_data.my_second_dbt_model
[0m20:24:53.388608 [info ] [Thread-2 (]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:24:53.388608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now model.telegram_data.my_second_dbt_model)
[0m20:24:53.393656 [debug] [Thread-2 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m20:24:53.398646 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m20:24:53.399641 [debug] [Thread-2 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m20:24:53.404958 [debug] [Thread-2 (]: Writing runtime sql for node "model.telegram_data.my_second_dbt_model"
[0m20:24:53.404958 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:24:53.404958 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: BEGIN
[0m20:24:53.404958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:24:53.432484 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m20:24:53.433481 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:24:53.433481 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.telegram_summary"} */

  create view "Telegram_data"."public"."telegram_summary__dbt_tmp"
    
    
  as (
    WITH transformed_data AS (
    SELECT * FROM "Telegram_data"."public"."select_all"
)

SELECT
    channel_name,
    COUNT(message_id) AS total_messages,
    MAX(timestamp) AS latest_message
FROM transformed_data
GROUP BY channel_name
  );
[0m20:24:53.529725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.123 seconds
[0m20:24:53.529725 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:24:53.529725 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */

  create view "Telegram_data"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Telegram_data"."public"."my_first_dbt_model"
where id = 1
  );
[0m20:24:53.546091 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:24:53.546091 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:24:53.546091 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
alter table "Telegram_data"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:24:53.546091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:24:53.546091 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m20:24:53.561147 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:24:53.561147 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: COMMIT
[0m20:24:53.577042 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m20:24:53.577042 [debug] [Thread-2 (]: Applying DROP to: "Telegram_data"."public"."my_second_dbt_model__dbt_backup"
[0m20:24:53.577042 [debug] [Thread-2 (]: Using postgres connection "model.telegram_data.my_second_dbt_model"
[0m20:24:53.577042 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.my_second_dbt_model"} */
drop view if exists "Telegram_data"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:24:53.592442 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:24:53.592442 [debug] [Thread-2 (]: On model.telegram_data.my_second_dbt_model: Close
[0m20:24:53.592442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78A5436D0>]}
[0m20:24:53.592442 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.20s]
[0m20:24:53.592442 [debug] [Thread-2 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m20:24:53.672367 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.238 seconds
[0m20:24:53.713894 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:24:53.713894 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.telegram_summary"} */
alter table "Telegram_data"."public"."telegram_summary__dbt_tmp" rename to "telegram_summary"
[0m20:24:53.713894 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:24:53.713894 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: COMMIT
[0m20:24:53.713894 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:24:53.713894 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: COMMIT
[0m20:24:53.713894 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:24:53.713894 [debug] [Thread-4 (]: Applying DROP to: "Telegram_data"."public"."telegram_summary__dbt_backup"
[0m20:24:53.713894 [debug] [Thread-4 (]: Using postgres connection "model.telegram_data.telegram_summary"
[0m20:24:53.713894 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "model.telegram_data.telegram_summary"} */
drop view if exists "Telegram_data"."public"."telegram_summary__dbt_backup" cascade
[0m20:24:53.729519 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:24:53.731591 [debug] [Thread-4 (]: On model.telegram_data.telegram_summary: Close
[0m20:24:53.731591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd57af8-ea6f-47be-97f9-2fa8460d267e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78A542C90>]}
[0m20:24:53.731591 [info ] [Thread-4 (]: 3 of 4 OK created sql view model public.telegram_summary ....................... [[32mCREATE VIEW[0m in 0.38s]
[0m20:24:53.731591 [debug] [Thread-4 (]: Finished running node model.telegram_data.telegram_summary
[0m20:24:53.731591 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.731591 [debug] [MainThread]: On master: BEGIN
[0m20:24:53.731591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:53.881769 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m20:24:53.881769 [debug] [MainThread]: On master: COMMIT
[0m20:24:53.881769 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:53.893776 [debug] [MainThread]: On master: COMMIT
[0m20:24:53.893776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:24:53.893776 [debug] [MainThread]: On master: Close
[0m20:24:53.893776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:53.893776 [debug] [MainThread]: Connection 'list_Telegram_data' was properly closed.
[0m20:24:53.893776 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m20:24:53.893776 [debug] [MainThread]: Connection 'model.telegram_data.my_first_dbt_model' was properly closed.
[0m20:24:53.893776 [debug] [MainThread]: Connection 'model.telegram_data.my_second_dbt_model' was properly closed.
[0m20:24:53.893776 [debug] [MainThread]: Connection 'model.telegram_data.telegram_summary' was properly closed.
[0m20:24:53.893776 [info ] [MainThread]: 
[0m20:24:53.893776 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m20:24:53.893776 [debug] [MainThread]: Command end result
[0m20:24:53.931064 [info ] [MainThread]: 
[0m20:24:53.931064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:53.931064 [info ] [MainThread]: 
[0m20:24:53.931064 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:24:53.931064 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:53.931064 after 2.49 seconds
[0m20:24:53.931064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E781D384D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7820B0ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E781E12F10>]}
[0m20:24:53.931064 [debug] [MainThread]: Flushing usage events
[0m20:24:55.730600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:33.151640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03CF1CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03CF71650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03CF73750>]}


============================== 20:30:33.230248 | f2025943-a7b2-4067-a4f3-6c95221e88cd ==============================
[0m20:30:33.230248 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:30:33.230248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:30:35.470206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03D261850>]}
[0m20:30:35.517122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03A374A10>]}
[0m20:30:35.532698 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:30:35.558352 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:30:36.003487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:36.003487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:36.050926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03D41AA50>]}
[0m20:30:36.757586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03D2BAD90>]}
[0m20:30:36.757586 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 423 macros
[0m20:30:36.757586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03D419610>]}
[0m20:30:36.757586 [info ] [MainThread]: 
[0m20:30:36.757586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:36.786250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m20:30:37.101457 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:30:37.102056 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m20:30:37.102056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:37.449057 [debug] [ThreadPool]: SQL status: BEGIN in 0.356 seconds
[0m20:30:37.449057 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:30:37.449057 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:30:37.496475 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m20:30:37.496475 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m20:30:37.559385 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m20:30:37.576529 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:37.576529 [debug] [MainThread]: On master: BEGIN
[0m20:30:37.576529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:37.618654 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m20:30:37.618654 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:37.618654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:37.650370 [debug] [MainThread]: SQL status: SELECT 3 in 0.030 seconds
[0m20:30:37.650370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2025943-a7b2-4067-a4f3-6c95221e88cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03D203C90>]}
[0m20:30:37.650370 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:37.650370 [debug] [MainThread]: On master: Close
[0m20:30:37.650370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:37.650370 [info ] [MainThread]: 
[0m20:30:37.731869 [debug] [Thread-1 (]: Began running node model.telegram_data.my_first_dbt_model
[0m20:30:37.733043 [debug] [Thread-2 (]: Began running node model.telegram_data.select_all
[0m20:30:37.734087 [debug] [Thread-3 (]: Began running node test.telegram_data.my_test
[0m20:30:37.737623 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_data.my_first_dbt_model'
[0m20:30:37.739134 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.telegram_data.select_all'
[0m20:30:37.740191 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.my_test'
[0m20:30:37.742128 [debug] [Thread-1 (]: Began compiling node model.telegram_data.my_first_dbt_model
[0m20:30:37.742789 [debug] [Thread-2 (]: Began compiling node model.telegram_data.select_all
[0m20:30:37.743612 [debug] [Thread-3 (]: Began compiling node test.telegram_data.my_test
[0m20:30:37.752472 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_data.my_first_dbt_model"
[0m20:30:37.757253 [debug] [Thread-2 (]: Writing injected SQL for node "model.telegram_data.select_all"
[0m20:30:37.759451 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.my_test"
[0m20:30:37.759451 [debug] [Thread-1 (]: Began executing node model.telegram_data.my_first_dbt_model
[0m20:30:37.759451 [debug] [Thread-2 (]: Began executing node model.telegram_data.select_all
[0m20:30:37.759451 [debug] [Thread-3 (]: Began executing node test.telegram_data.my_test
[0m20:30:37.759451 [debug] [Thread-1 (]: Finished running node model.telegram_data.my_first_dbt_model
[0m20:30:37.759451 [debug] [Thread-2 (]: Finished running node model.telegram_data.select_all
[0m20:30:37.759451 [debug] [Thread-3 (]: Finished running node test.telegram_data.my_test
[0m20:30:37.769705 [debug] [Thread-4 (]: Began running node model.telegram_data.my_second_dbt_model
[0m20:30:37.770711 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:37.772113 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:30:37.772113 [debug] [Thread-3 (]: Began running node model.telegram_data.telegram_summary
[0m20:30:37.772113 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.telegram_data.my_second_dbt_model'
[0m20:30:37.772113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_first_dbt_model, now test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m20:30:37.772113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.telegram_data.select_all, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m20:30:37.772113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.telegram_data.my_test, now model.telegram_data.telegram_summary)
[0m20:30:37.772113 [debug] [Thread-4 (]: Began compiling node model.telegram_data.my_second_dbt_model
[0m20:30:37.772113 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:37.772113 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:30:37.772113 [debug] [Thread-3 (]: Began compiling node model.telegram_data.telegram_summary
[0m20:30:37.772113 [debug] [Thread-4 (]: Writing injected SQL for node "model.telegram_data.my_second_dbt_model"
[0m20:30:37.794748 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:30:37.800728 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:30:37.804743 [debug] [Thread-3 (]: Writing injected SQL for node "model.telegram_data.telegram_summary"
[0m20:30:37.806699 [debug] [Thread-4 (]: Began executing node model.telegram_data.my_second_dbt_model
[0m20:30:37.807697 [debug] [Thread-4 (]: Finished running node model.telegram_data.my_second_dbt_model
[0m20:30:37.808693 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:30:37.809687 [debug] [Thread-3 (]: Began executing node model.telegram_data.telegram_summary
[0m20:30:37.809687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.telegram_data.my_second_dbt_model, now test.telegram_data.not_null_select_all_message_id.63a0c4ebb3)
[0m20:30:37.811681 [debug] [Thread-3 (]: Finished running node model.telegram_data.telegram_summary
[0m20:30:37.812222 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:30:37.812872 [debug] [Thread-3 (]: Began running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:30:37.817941 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:30:37.818938 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.telegram_data.telegram_summary, now test.telegram_data.unique_select_all_message_id.996fbafff2)
[0m20:30:37.819943 [debug] [Thread-3 (]: Began compiling node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:30:37.821163 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m20:30:37.852912 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:37.852912 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:30:37.852912 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:30:37.852912 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:30:37.852912 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:37.852912 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:37.852912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.not_null_my_second_dbt_model_id.151b76d778)
[0m20:30:37.852912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.unique_my_first_dbt_model_id.16e066b321, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m20:30:37.852912 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:37.852912 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:37.868576 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:30:37.868576 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:30:37.884951 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:30:37.886850 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:30:37.886850 [debug] [Thread-3 (]: Began executing node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:30:37.886850 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:30:37.886850 [debug] [Thread-3 (]: Finished running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:30:37.886850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_select_all_message_id.63a0c4ebb3, now test.telegram_data.not_null_telegram_summary_channel_name.9965527363)
[0m20:30:37.886850 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:30:37.886850 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:30:37.886850 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:37.886850 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:37.899922 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:30:37.899922 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:30:37.899922 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:30:37.899922 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:30:37.915551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Connection 'test.telegram_data.unique_select_all_message_id.996fbafff2' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363' was properly closed.
[0m20:30:37.915551 [debug] [MainThread]: Command end result
[0m20:30:38.153775 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:30:38.153775 [info ] [MainThread]: Building catalog
[0m20:30:38.176354 [debug] [ThreadPool]: Acquiring new postgres connection 'Telegram_data.information_schema'
[0m20:30:38.179413 [debug] [ThreadPool]: Using postgres connection "Telegram_data.information_schema"
[0m20:30:38.179413 [debug] [ThreadPool]: On Telegram_data.information_schema: BEGIN
[0m20:30:38.186449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:38.333583 [debug] [ThreadPool]: SQL status: BEGIN in 0.153 seconds
[0m20:30:38.333583 [debug] [ThreadPool]: Using postgres connection "Telegram_data.information_schema"
[0m20:30:38.340590 [debug] [ThreadPool]: On Telegram_data.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "Telegram_data.information_schema"} */

    
    

    select
        'Telegram_data' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('transformed_telegram_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('telegram_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('select_all')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:30:38.449284 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.108 seconds
[0m20:30:38.475409 [debug] [ThreadPool]: On Telegram_data.information_schema: ROLLBACK
[0m20:30:38.475409 [debug] [ThreadPool]: On Telegram_data.information_schema: Close
[0m20:30:38.505539 [info ] [MainThread]: Catalog written to C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data\target\catalog.json
[0m20:30:38.505539 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:30:38.505539 after 5.70 seconds
[0m20:30:38.505539 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:30:38.505539 [debug] [MainThread]: Connection 'Telegram_data.information_schema' was properly closed.
[0m20:30:38.505539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0369D3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0369D2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A03CE2C4D0>]}
[0m20:30:38.505539 [debug] [MainThread]: Flushing usage events
[0m20:30:40.727716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:47.938880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FB2EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FA2BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FB2D950>]}


============================== 20:31:47.947437 | 5ff7378f-b28e-47e2-9480-4a7638dd3121 ==============================
[0m20:31:47.947437 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:31:47.947437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:31:48.117581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ff7378f-b28e-47e2-9480-4a7638dd3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FE21B10>]}
[0m20:31:48.164919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ff7378f-b28e-47e2-9480-4a7638dd3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370CF84B10>]}
[0m20:35:01.411579 [error] [MainThread]: Encountered an error:

[0m20:35:01.521995 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\myenv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:35:01.549506 [debug] [MainThread]: Command `dbt docs serve` failed at 20:35:01.549506 after 193.67 seconds
[0m20:35:01.554010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370EC41A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FB872D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002370FB85610>]}
[0m20:35:01.555106 [debug] [MainThread]: Flushing usage events
[0m20:35:02.433508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:19.509265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77418B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7741B7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7741B7190>]}


============================== 20:39:19.509265 | 70186d47-742a-4e25-be1f-72e8baad939a ==============================
[0m20:39:19.509265 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:39:19.524884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:39:19.597204 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `target-path` config in `dbt_project.yml` has been deprecated, and will no
longer be supported in a future version of dbt-core. If you wish to write dbt
artifacts to a custom directory, please use the --target-path CLI flag or
DBT_TARGET_PATH env var instead.
[0m20:39:19.598122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70186d47-742a-4e25-be1f-72e8baad939a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7744B2E10>]}
[0m20:39:19.647395 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('log_path' was unexpected)

Error encountered in C:\Users\USER\Documents\OPLearning\10_Academy\Week_7\telegram_data\dbt_project.yml
[0m20:39:19.647395 [debug] [MainThread]: Command `dbt test` failed at 20:39:19.647395 after 0.27 seconds
[0m20:39:19.659949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76DB484D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76DC23B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B76DBE2350>]}
[0m20:39:19.659949 [debug] [MainThread]: Flushing usage events
[0m20:39:20.814735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:39.000753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B543FB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B5444F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B5444D890>]}


============================== 20:39:39.016423 | 37274797-5755-4195-a899-c65a7631088f ==============================
[0m20:39:39.016423 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:39:39.016423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:39.210010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B54765E90>]}
[0m20:39:39.287409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B51854A90>]}
[0m20:39:39.287409 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:39:39.304081 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:39:39.430513 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:39:39.432501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B547F1350>]}
[0m20:39:40.796683 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:39:40.796683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37274797-5755-4195-a899-c65a7631088f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B548A4650>]}
[0m20:39:41.133499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B549EF2D0>]}
[0m20:39:41.433161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B543FA4D0>]}
[0m20:39:41.434158 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 423 macros
[0m20:39:41.435236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B54AF2E90>]}
[0m20:39:41.435236 [info ] [MainThread]: 
[0m20:39:41.435236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:41.445133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m20:39:41.526426 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:39:41.526426 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m20:39:41.527425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:41.679237 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m20:39:41.679237 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:39:41.679237 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:39:41.679237 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m20:39:41.697403 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m20:39:41.698919 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m20:39:41.704901 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:41.705898 [debug] [MainThread]: On master: BEGIN
[0m20:39:41.705898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:41.745598 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m20:39:41.745598 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:41.745598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:41.761149 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m20:39:41.761149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37274797-5755-4195-a899-c65a7631088f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B55B329D0>]}
[0m20:39:41.761149 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:41.761149 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:41.761149 [debug] [MainThread]: On master: BEGIN
[0m20:39:41.761149 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:39:41.761149 [debug] [MainThread]: On master: COMMIT
[0m20:39:41.761149 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:41.776778 [debug] [MainThread]: On master: COMMIT
[0m20:39:41.776778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:41.776778 [debug] [MainThread]: On master: Close
[0m20:39:41.776778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:41.776778 [info ] [MainThread]: 
[0m20:39:41.776778 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:39:41.776778 [debug] [Thread-2 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:39:41.776778 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:39:41.776778 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:39:41.776778 [info ] [Thread-1 (]: 1 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:39:41.776778 [info ] [Thread-2 (]: 2 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:39:41.790260 [info ] [Thread-3 (]: 3 of 7 START test not_null_select_all_message_id ............................... [RUN]
[0m20:39:41.791517 [info ] [Thread-4 (]: 4 of 7 START test not_null_telegram_summary_channel_name ....................... [RUN]
[0m20:39:41.792320 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:39:41.794344 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778'
[0m20:39:41.794344 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_select_all_message_id.63a0c4ebb3'
[0m20:39:41.796463 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363'
[0m20:39:41.796463 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:39:41.798467 [debug] [Thread-2 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:39:41.798467 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:39:41.798467 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:39:41.823113 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:39:41.826156 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:39:41.829770 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:39:41.829770 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:39:41.829770 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:39:41.829770 [debug] [Thread-2 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:39:41.829770 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:39:41.862928 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:39:41.862928 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:39:41.869139 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:39:41.872194 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:39:41.876156 [debug] [Thread-4 (]: Writing runtime sql for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:39:41.901372 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:39:41.901372 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:39:41.901372 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: BEGIN
[0m20:39:41.901372 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: BEGIN
[0m20:39:41.901372 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:39:41.901372 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:41.918197 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:39:41.919190 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:39:41.921187 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:39:41.922179 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:39:41.924173 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:41.925170 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:39:41.962867 [debug] [Thread-4 (]: SQL status: BEGIN in 0.063 seconds
[0m20:39:41.962867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m20:39:41.962867 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:39:41.962867 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:39:41.962867 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "Telegram_data"."public"."telegram_summary"
where channel_name is null



      
    ) dbt_internal_test
[0m20:39:41.962867 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "Telegram_data"."public"."select_all"
where message_id is null



      
    ) dbt_internal_test
[0m20:39:41.962867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m20:39:41.978554 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:39:41.978554 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:39:41.978554 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:39:41.978554 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:39:41.978554 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:39:41.978554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m20:39:41.978554 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:39:41.978554 [error] [Thread-1 (]: 1 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.19s]
[0m20:39:41.978554 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:39:41.978554 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:39:41.978554 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:39:41.994114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:39:41.994114 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:39:41.994114 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:39:41.978554 [info ] [Thread-1 (]: 5 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:39:41.998618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m20:39:41.998618 [info ] [Thread-2 (]: 2 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.20s]
[0m20:39:41.998618 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:39:42.010892 [debug] [Thread-2 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:39:42.010892 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:39:42.010892 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:39:42.010892 [info ] [Thread-2 (]: 6 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:39:42.010892 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:39:42.024701 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.048 seconds
[0m20:39:42.025707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_second_dbt_model_id.151b76d778, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m20:39:42.031092 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:39:42.035009 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: ROLLBACK
[0m20:39:42.035009 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.059 seconds
[0m20:39:42.036340 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:39:42.036980 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: Close
[0m20:39:42.039112 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: ROLLBACK
[0m20:39:42.039112 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:39:42.039112 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:39:42.046833 [info ] [Thread-3 (]: 3 of 7 PASS not_null_select_all_message_id ..................................... [[32mPASS[0m in 0.25s]
[0m20:39:42.048221 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: Close
[0m20:39:42.048221 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:39:42.048221 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:39:42.048221 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:39:42.048221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:42.048221 [info ] [Thread-4 (]: 4 of 7 PASS not_null_telegram_summary_channel_name ............................. [[32mPASS[0m in 0.25s]
[0m20:39:42.056357 [debug] [Thread-3 (]: Began running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:39:42.060351 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:39:42.061344 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:39:42.063089 [info ] [Thread-3 (]: 7 of 7 START test unique_select_all_message_id ................................. [RUN]
[0m20:39:42.063089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_select_all_message_id.63a0c4ebb3, now test.telegram_data.unique_select_all_message_id.996fbafff2)
[0m20:39:42.063089 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:39:42.063089 [debug] [Thread-3 (]: Began compiling node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:39:42.063089 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:39:42.070495 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m20:39:42.070495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:42.078002 [debug] [Thread-3 (]: Began executing node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:39:42.080457 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m20:39:42.098673 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m20:39:42.100114 [debug] [Thread-3 (]: On test.telegram_data.unique_select_all_message_id.996fbafff2: BEGIN
[0m20:39:42.101110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:42.113694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m20:39:42.113694 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:39:42.113694 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:42.113694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:39:42.113694 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:39:42.113694 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:39:42.113694 [info ] [Thread-1 (]: 5 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.12s]
[0m20:39:42.113694 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:39:42.231032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m20:39:42.232072 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:39:42.233060 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:42.235016 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:39:42.237012 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:39:42.238078 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:39:42.239051 [info ] [Thread-2 (]: 6 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.21s]
[0m20:39:42.240998 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:39:42.247768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.147 seconds
[0m20:39:42.248808 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.unique_select_all_message_id.996fbafff2"
[0m20:39:42.248808 [debug] [Thread-3 (]: On test.telegram_data.unique_select_all_message_id.996fbafff2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_select_all_message_id.996fbafff2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."select_all"
where message_id is not null
group by message_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:39:42.300334 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.051 seconds
[0m20:39:42.304599 [debug] [Thread-3 (]: On test.telegram_data.unique_select_all_message_id.996fbafff2: ROLLBACK
[0m20:39:42.304599 [debug] [Thread-3 (]: On test.telegram_data.unique_select_all_message_id.996fbafff2: Close
[0m20:39:42.304599 [error] [Thread-3 (]: 7 of 7 FAIL 1133 unique_select_all_message_id .................................. [[31mFAIL 1133[0m in 0.24s]
[0m20:39:42.304599 [debug] [Thread-3 (]: Finished running node test.telegram_data.unique_select_all_message_id.996fbafff2
[0m20:39:42.313251 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:42.314105 [debug] [MainThread]: On master: BEGIN
[0m20:39:42.314105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:42.463291 [debug] [MainThread]: SQL status: BEGIN in 0.150 seconds
[0m20:39:42.463291 [debug] [MainThread]: On master: COMMIT
[0m20:39:42.463291 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:42.463291 [debug] [MainThread]: On master: COMMIT
[0m20:39:42.463291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:42.463291 [debug] [MainThread]: On master: Close
[0m20:39:42.463291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:42.463291 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m20:39:42.463291 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:39:42.463291 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:39:42.463291 [debug] [MainThread]: Connection 'test.telegram_data.unique_select_all_message_id.996fbafff2' was properly closed.
[0m20:39:42.463291 [debug] [MainThread]: Connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363' was properly closed.
[0m20:39:42.463291 [info ] [MainThread]: 
[0m20:39:42.463291 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m20:39:42.463291 [debug] [MainThread]: Command end result
[0m20:39:42.514292 [info ] [MainThread]: 
[0m20:39:42.516282 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:39:42.517278 [info ] [MainThread]: 
[0m20:39:42.518184 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:39:42.518184 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:39:42.518184 [info ] [MainThread]: 
[0m20:39:42.518184 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:39:42.518184 [info ] [MainThread]: 
[0m20:39:42.526112 [error] [MainThread]: [31mFailure in test unique_select_all_message_id (models\schema.yml)[0m
[0m20:39:42.527117 [error] [MainThread]:   Got 1133 results, configured to fail if != 0
[0m20:39:42.529107 [info ] [MainThread]: 
[0m20:39:42.531100 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\schema.yml\unique_select_all_message_id.sql
[0m20:39:42.532099 [info ] [MainThread]: 
[0m20:39:42.534093 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m20:39:42.537148 [debug] [MainThread]: Command `dbt test` failed at 20:39:42.536085 after 3.60 seconds
[0m20:39:42.538147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4DE284D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B54466DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B544649D0>]}
[0m20:39:42.539454 [debug] [MainThread]: Flushing usage events
[0m20:39:43.413695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:47.326091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FAE2F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FAE5B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FA3AD210>]}


============================== 20:44:47.335639 | 7b9c4a32-a230-4469-9b3a-25b2f0d1bafa ==============================
[0m20:44:47.335639 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:44:47.335639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\USER\\Documents\\OPLearning\\10_Academy\\Week_7\\telegram_data', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:47.514869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FB1A0A10>]}
[0m20:44:47.584103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107F8284B10>]}
[0m20:44:47.585104 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:44:47.598206 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:44:47.872471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:47.872471 [debug] [MainThread]: Partial parsing: updated file: telegram_data://models\schema.yml
[0m20:44:48.061656 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:44:48.061656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FB48C510>]}
[0m20:44:48.247507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FB439B10>]}
[0m20:44:48.389306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FC8FBE50>]}
[0m20:44:48.389306 [info ] [MainThread]: Found 4 models, 7 data tests, 1 source, 423 macros
[0m20:44:48.389306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FB569990>]}
[0m20:44:48.389306 [info ] [MainThread]: 
[0m20:44:48.389306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:44:48.408883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Telegram_data_public'
[0m20:44:48.484857 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:44:48.485098 [debug] [ThreadPool]: On list_Telegram_data_public: BEGIN
[0m20:44:48.485098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:48.666706 [debug] [ThreadPool]: SQL status: BEGIN in 0.181 seconds
[0m20:44:48.667532 [debug] [ThreadPool]: Using postgres connection "list_Telegram_data_public"
[0m20:44:48.667532 [debug] [ThreadPool]: On list_Telegram_data_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "list_Telegram_data_public"} */
select
      'Telegram_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Telegram_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:44:48.667532 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m20:44:48.667532 [debug] [ThreadPool]: On list_Telegram_data_public: ROLLBACK
[0m20:44:48.667532 [debug] [ThreadPool]: On list_Telegram_data_public: Close
[0m20:44:48.682535 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:48.682535 [debug] [MainThread]: On master: BEGIN
[0m20:44:48.682535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:48.839175 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m20:44:48.839175 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:48.839175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:44:48.854857 [debug] [MainThread]: SQL status: SELECT 3 in 0.011 seconds
[0m20:44:48.854857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b9c4a32-a230-4469-9b3a-25b2f0d1bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FA3D7310>]}
[0m20:44:48.854857 [debug] [MainThread]: On master: ROLLBACK
[0m20:44:48.854857 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:48.854857 [debug] [MainThread]: On master: BEGIN
[0m20:44:48.861363 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:44:48.861363 [debug] [MainThread]: On master: COMMIT
[0m20:44:48.861363 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:48.861363 [debug] [MainThread]: On master: COMMIT
[0m20:44:48.861363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:48.861363 [debug] [MainThread]: On master: Close
[0m20:44:48.861363 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:48.861363 [info ] [MainThread]: 
[0m20:44:48.871780 [debug] [Thread-1 (]: Began running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:44:48.871780 [debug] [Thread-2 (]: Began running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:44:48.873072 [debug] [Thread-3 (]: Began running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:44:48.874100 [debug] [Thread-4 (]: Began running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:44:48.874100 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:44:48.875096 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m20:44:48.877483 [info ] [Thread-3 (]: 3 of 6 START test not_null_select_all_message_id ............................... [RUN]
[0m20:44:48.877483 [info ] [Thread-4 (]: 4 of 6 START test not_null_telegram_summary_channel_name ....................... [RUN]
[0m20:44:48.877483 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:44:48.877483 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.telegram_data.not_null_my_second_dbt_model_id.151b76d778'
[0m20:44:48.877483 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.telegram_data.not_null_select_all_message_id.63a0c4ebb3'
[0m20:44:48.877483 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363'
[0m20:44:48.884135 [debug] [Thread-1 (]: Began compiling node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:44:48.885140 [debug] [Thread-2 (]: Began compiling node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:44:48.886469 [debug] [Thread-3 (]: Began compiling node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:44:48.887664 [debug] [Thread-4 (]: Began compiling node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:44:48.910398 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:44:48.918486 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:44:48.925529 [debug] [Thread-3 (]: Writing injected SQL for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:44:48.928208 [debug] [Thread-4 (]: Writing injected SQL for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:44:48.928208 [debug] [Thread-1 (]: Began executing node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:44:48.934107 [debug] [Thread-2 (]: Began executing node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:44:48.935919 [debug] [Thread-3 (]: Began executing node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:44:48.951073 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:44:48.952132 [debug] [Thread-4 (]: Began executing node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:44:48.955129 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:44:48.958081 [debug] [Thread-3 (]: Writing runtime sql for node "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:44:48.961475 [debug] [Thread-4 (]: Writing runtime sql for node "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:44:48.962474 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:44:48.963471 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:44:48.964468 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:44:48.965465 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:44:48.965465 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m20:44:48.966461 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m20:44:48.967788 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: BEGIN
[0m20:44:48.967788 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: BEGIN
[0m20:44:48.969008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:44:48.969587 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:44:48.970367 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:44:48.970911 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:44:49.016892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m20:44:49.016892 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:44:49.016892 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:44:49.016892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:44:49.032519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.064 seconds
[0m20:44:49.032519 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m20:44:49.032519 [debug] [Thread-3 (]: SQL status: BEGIN in 0.065 seconds
[0m20:44:49.032519 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"
[0m20:44:49.032519 [debug] [Thread-4 (]: SQL status: BEGIN in 0.065 seconds
[0m20:44:49.032519 [debug] [Thread-1 (]: On test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:44:49.032519 [debug] [Thread-3 (]: Using postgres connection "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"
[0m20:44:49.032519 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "Telegram_data"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m20:44:49.032519 [debug] [Thread-4 (]: Using postgres connection "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"
[0m20:44:49.032519 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_select_all_message_id.63a0c4ebb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select message_id
from "Telegram_data"."public"."select_all"
where message_id is null



      
    ) dbt_internal_test
[0m20:44:49.032519 [error] [Thread-1 (]: 1 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.16s]
[0m20:44:49.032519 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.not_null_telegram_summary_channel_name.9965527363"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select channel_name
from "Telegram_data"."public"."telegram_summary"
where channel_name is null



      
    ) dbt_internal_test
[0m20:44:49.032519 [debug] [Thread-1 (]: Finished running node test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:44:49.032519 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:44:49.032519 [debug] [Thread-1 (]: Began running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:44:49.048208 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:44:49.032519 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m20:44:49.049331 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:44:49.050734 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:44:49.053466 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: ROLLBACK
[0m20:44:49.054463 [debug] [Thread-2 (]: On test.telegram_data.not_null_my_second_dbt_model_id.151b76d778: Close
[0m20:44:49.054463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.telegram_data.unique_my_first_dbt_model_id.16e066b321)
[0m20:44:49.055502 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: ROLLBACK
[0m20:44:49.055502 [debug] [Thread-3 (]: On test.telegram_data.not_null_select_all_message_id.63a0c4ebb3: Close
[0m20:44:49.055502 [debug] [Thread-1 (]: Began compiling node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:44:49.055502 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.18s]
[0m20:44:49.060541 [debug] [Thread-4 (]: On test.telegram_data.not_null_telegram_summary_channel_name.9965527363: Close
[0m20:44:49.061548 [info ] [Thread-3 (]: 3 of 6 PASS not_null_select_all_message_id ..................................... [[32mPASS[0m in 0.18s]
[0m20:44:49.072955 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:44:49.073952 [debug] [Thread-2 (]: Finished running node test.telegram_data.not_null_my_second_dbt_model_id.151b76d778
[0m20:44:49.077010 [debug] [Thread-3 (]: Finished running node test.telegram_data.not_null_select_all_message_id.63a0c4ebb3
[0m20:44:49.075486 [info ] [Thread-4 (]: 4 of 6 PASS not_null_telegram_summary_channel_name ............................. [[32mPASS[0m in 0.20s]
[0m20:44:49.078011 [debug] [Thread-2 (]: Began running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:44:49.080004 [debug] [Thread-1 (]: Began executing node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:44:49.081001 [debug] [Thread-4 (]: Finished running node test.telegram_data.not_null_telegram_summary_channel_name.9965527363
[0m20:44:49.081999 [info ] [Thread-2 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m20:44:49.086018 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:44:49.088496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.telegram_data.not_null_my_second_dbt_model_id.151b76d778, now test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m20:44:49.089492 [debug] [Thread-2 (]: Began compiling node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:44:49.094751 [debug] [Thread-2 (]: Writing injected SQL for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:44:49.095725 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:44:49.096722 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m20:44:49.096722 [debug] [Thread-2 (]: Began executing node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:44:49.096722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:49.102301 [debug] [Thread-2 (]: Writing runtime sql for node "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:44:49.103709 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:44:49.103709 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m20:44:49.103709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:44:49.164505 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m20:44:49.165563 [debug] [Thread-2 (]: Using postgres connection "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m20:44:49.165563 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:44:49.169590 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:44:49.171612 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m20:44:49.172716 [debug] [Thread-2 (]: On test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m20:44:49.173716 [info ] [Thread-2 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
[0m20:44:49.174716 [debug] [Thread-2 (]: Finished running node test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493
[0m20:44:49.270882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.173 seconds
[0m20:44:49.271879 [debug] [Thread-1 (]: Using postgres connection "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"
[0m20:44:49.272875 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "telegram_data", "target_name": "dev", "node_id": "test.telegram_data.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "Telegram_data"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:44:49.276860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:44:49.279849 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m20:44:49.280846 [debug] [Thread-1 (]: On test.telegram_data.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:44:49.281842 [info ] [Thread-1 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.23s]
[0m20:44:49.283836 [debug] [Thread-1 (]: Finished running node test.telegram_data.unique_my_first_dbt_model_id.16e066b321
[0m20:44:49.285829 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:49.285829 [debug] [MainThread]: On master: BEGIN
[0m20:44:49.285829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:49.325439 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m20:44:49.325439 [debug] [MainThread]: On master: COMMIT
[0m20:44:49.334219 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:49.335225 [debug] [MainThread]: On master: COMMIT
[0m20:44:49.337292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:49.337292 [debug] [MainThread]: On master: Close
[0m20:44:49.337292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:49.337292 [debug] [MainThread]: Connection 'list_Telegram_data_public' was properly closed.
[0m20:44:49.340628 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:44:49.340628 [debug] [MainThread]: Connection 'test.telegram_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m20:44:49.340628 [debug] [MainThread]: Connection 'test.telegram_data.not_null_select_all_message_id.63a0c4ebb3' was properly closed.
[0m20:44:49.340628 [debug] [MainThread]: Connection 'test.telegram_data.not_null_telegram_summary_channel_name.9965527363' was properly closed.
[0m20:44:49.340628 [info ] [MainThread]: 
[0m20:44:49.340628 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m20:44:49.340628 [debug] [MainThread]: Command end result
[0m20:44:49.432881 [info ] [MainThread]: 
[0m20:44:49.434457 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:49.435493 [info ] [MainThread]: 
[0m20:44:49.436493 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:44:49.437489 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:44:49.438534 [info ] [MainThread]: 
[0m20:44:49.439580 [info ] [MainThread]:   compiled code at target\compiled\telegram_data\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:44:49.440581 [info ] [MainThread]: 
[0m20:44:49.441581 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:44:49.442573 [debug] [MainThread]: Command `dbt test` failed at 20:44:49.442573 after 2.18 seconds
[0m20:44:49.443605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107F47D84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107F4872350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000107FC677C50>]}
[0m20:44:49.444619 [debug] [MainThread]: Flushing usage events
[0m20:44:50.551553 [debug] [MainThread]: An error was encountered while trying to flush usage events
